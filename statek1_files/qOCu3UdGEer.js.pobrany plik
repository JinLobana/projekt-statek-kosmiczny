if (self.CavalryLogger) { CavalryLogger.start_js(["bwcUpcb"]); }

__d("DetectBrokenProxyCache",["AsyncSignal","Cookie","URI"],(function(a,b,c,d,e,f){var g;function a(a,c){var d=b("Cookie").get(c);if(d!=a&&d!=null&&a!="0"){c={c:"si_detect_broken_proxy_cache",m:c+" "+a+" "+d};a=new(g||(g=b("URI")))("/common/scribe_endpoint.php").getQualifiedURI().toString();new(b("AsyncSignal"))(a,c).send()}}e.exports={run:a}}),null);
__d("CometRouteActorToasterQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"scale"}],b={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:"toast_icon",args:[{kind:"Literal",name:"height",value:32},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:32}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CometRouteActorToasterQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[b,c,d],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CometRouteActorToasterQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[b,c,d,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"3701359813324681",metadata:{},name:"CometRouteActorToasterQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("PresenceStatusProviderSubscriptionComponentQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"count"},{defaultValue:null,kind:"LocalArgument",name:"scale"}],b=[{kind:"Variable",name:"count",variableName:"count"}],c={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"buddy_id",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"PresenceStatusProviderSubscriptionComponentQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:b,concreteType:"ChatSidebarRankedContact",kind:"LinkedField",name:"chat_sidebar_contact_rankings",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"PresenceStatusProviderSubscription_rankings",selections:[c,d,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[e,{args:null,kind:"FragmentSpread",name:"MWChatContact_profile"}],storageKey:null}]}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"PresenceStatusProviderSubscriptionComponentQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:b,concreteType:"ChatSidebarRankedContact",kind:"LinkedField",name:"chat_sidebar_contact_rankings",plural:!0,selections:[c,d,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[e,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:36},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:36}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Contact",kind:"LinkedField",name:"messenger_contact",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"restriction_type",storageKey:null},e],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_active_time",storageKey:null}]}],type:"User",abstractKey:null}],type:"Profile",abstractKey:"__isProfile"}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"4294108243974955",metadata:{},name:"PresenceStatusProviderSubscriptionComponentQuery",operationKind:"query",text:null}}}();a.params.id!=null&&b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("PresenceStatusProviderSubscription_ContactProfilesQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"ids"},{defaultValue:null,kind:"LocalArgument",name:"scale"}],b=[{kind:"Variable",name:"ids",variableName:"ids"}],c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},e={alias:null,args:[{kind:"Literal",name:"height",value:36},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:36}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"PresenceStatusProviderSubscription_ContactProfilesQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:b,concreteType:null,kind:"LinkedField",name:"chat_sidebar_contact_nodes",plural:!0,selections:[c,d,e],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"PresenceStatusProviderSubscription_ContactProfilesQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:b,concreteType:null,kind:"LinkedField",name:"chat_sidebar_contact_nodes",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c,{kind:"TypeDiscriminator",abstractKey:"__isProfile"},d,e],storageKey:null}],storageKey:null}]},params:{id:"3663158690459508",metadata:{},name:"PresenceStatusProviderSubscription_ContactProfilesQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("PresenceStatusProviderSubscription_PresenceStatusChatVisibilityQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"chat_visibility",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"has_converted_to_view_side_settings",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PresenceStatusProviderSubscription_PresenceStatusChatVisibilityQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[a,{alias:null,args:null,concreteType:"PresenceViewerBasedSettings",kind:"LinkedField",name:"presence_view_side_settings",plural:!1,selections:[b],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PresenceStatusProviderSubscription_PresenceStatusChatVisibilityQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[a,{alias:null,args:null,concreteType:"PresenceViewerBasedSettings",kind:"LinkedField",name:"presence_view_side_settings",plural:!1,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"2607318959337318",metadata:{},name:"PresenceStatusProviderSubscription_PresenceStatusChatVisibilityQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("PresenceStatusProviderSubscription_rankings.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"PresenceStatusProviderSubscription_rankings"};e.exports=a}),null);
__d("RTWebCallBlockSettingHooksQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"call_blocked_until",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RTWebCallBlockSettingHooksQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"RTWebCallBlockSettingHooksQuery",selections:a},params:{id:"5359827550755125",metadata:{},name:"RTWebCallBlockSettingHooksQuery",operationKind:"query",text:null}}}();a.params.id!=null&&b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("RTWebCometRoomIncomingCallDialog_DisclaimerQuery$Parameters",[],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:"5077922372277873",metadata:{},name:"RTWebCometRoomIncomingCallDialog_DisclaimerQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("FleetBeaconSubscriptionNetwork_LogMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"FleetBeaconLogResponsePayload",kind:"LinkedField",name:"fleet_beacon_log",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FleetBeaconSubscriptionNetwork_LogMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FleetBeaconSubscriptionNetwork_LogMutation",selections:b},params:{id:"4501085869904851",metadata:{},name:"FleetBeaconSubscriptionNetwork_LogMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("FleetBeaconSubscriptionNetwork_PublishMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"FleetBeaconPublishResponsePayload",kind:"LinkedField",name:"fleet_beacon_publish",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FleetBeaconSubscriptionNetwork_PublishMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FleetBeaconSubscriptionNetwork_PublishMutation",selections:b},params:{id:"3918234471547751",metadata:{},name:"FleetBeaconSubscriptionNetwork_PublishMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("FleetBeaconSubscriptionNetwork_Subscription.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"TestFleetBeaconSubscribeResponsePayload",kind:"LinkedField",name:"test_fleet_beacon_subscribe",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_subscription_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"test_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FleetBeaconSubscriptionNetwork_Subscription",selections:b,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FleetBeaconSubscriptionNetwork_Subscription",selections:b},params:{id:"3194829573871785",metadata:{subscriptionName:"test_fleet_beacon_subscribe"},name:"FleetBeaconSubscriptionNetwork_Subscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("CometVirtualCursorStatus",["UserAgent","cr:1345969","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=null;function j(){i||(i=window.addEventListener("blur",function(){h=null,k()}))}function k(){i&&(i.remove(),i=null)}function a(a){h=a.keyCode,j()}function d(a){h=null,k()}if(typeof window!=="undefined"&&window.document&&window.document.createElement){f=document.documentElement;if(f)if(f.addEventListener)f.addEventListener("keydown",a,!0),f.addEventListener("keyup",d,!0);else if(f.attachEvent){f=f.attachEvent;f("onkeydown",a);f("onkeyup",d)}}var l={getKeyDownCode:function(){return h},isKeyDown:function(){return!!h}},m=!1,n=!1,o=null,p=!1;function q(a){var b=new Set(),d=l.isKeyDown(),e=a.WEBKIT_FORCE_AT_MOUSE_DOWN,f=a.clientX,g=a.clientY,h=a.isTrusted,i=a.mozInputSource,j=a.offsetX,k=a.offsetY,o=a.webkitForce;f===0&&g===0&&j>=0&&k>=0&&n&&h&&i==null&&b.add("Chrome");m&&n&&!d&&o!=null&&o<e&&j===0&&k===0&&i==null&&b.add("Safari-edge");f===0&&g===0&&j<0&&k<0&&n&&i==null&&b.add("Safari-old");if(!m&&!n&&!d&&h&&c("UserAgent").isBrowser("IE >= 10")&&i==null){o=a.target;e=o.clientHeight;d=o.clientWidth;f<0&&g<0?b.add("IE"):(j<0||j>d)&&(k<0||k>e)&&b.add("MSIE")}i===0&&h&&b.add("Firefox");return b}function r(){m=!0,c("setTimeout")(function(){m=!1},0)}function s(){n=!0,c("setTimeout")(function(){n=!1},0)}function t(a){p&&b("cr:1345969").log({extra_data:{source_app:"comet"},indicated_browsers:o,is_virtual_cursor_action:a})}function u(a){o===null&&(o=Array.from(q(a)));p=o!=null&&o.length>0;a=a.target!=null&&a.target.getAttribute!=null&&a.target.getAttribute("data-accessibilityid")==="virtual_cursor_trigger";t(a);c("setTimeout")(function(){p=!1,o=null},0)}function e(){document.addEventListener("click",u,!0),document.addEventListener("mousedown",r,!0),document.addEventListener("mouseup",s,!0)}g.initLogging=e}),98);
__d("CometBootloaderEventsTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:CometBootloaderEventsLoggerConfig")}),null);
__d("HasteResponseFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1823926");c=b("FalcoLoggerInternal").create("haste_response",a);e.exports=c}),null);
__d("CometBootloaderLoggerUtil",["BootloaderEvents","BootloaderEventsPerf","CometBootloaderEventsTypedLoggerLite","CometTimeSpentNavigation","HasteResponseFalcoEvent","ResourceTimingStore","SiteData","performanceNavigationStart"],(function(a,b,c,d,e,f,g){"use strict";var h=!1;function a(a){var b=a.bl_sample_rate,e=a.hr_sample_rate,f=a.parent_lid;if(h||!(b||e))return;h=!0;d("ResourceTimingStore").init();var g=function(a){return{ms_since_navstart:Math.round(a-c("performanceNavigationStart")()),parent_lid:f,pkg_cohort:c("SiteData").pkg_cohort,request_path:(a=c("CometTimeSpentNavigation").getPathInfo())==null?void 0:a.name,svn_rev:c("SiteData").client_revision}};e&&d("BootloaderEvents").onHasteResponse(function(a){return c("HasteResponseFalcoEvent").log(function(){var b=d("BootloaderEventsPerf").computeHRData(a),c=d("BootloaderEventsPerf").flattenData(b);return babelHelpers["extends"]({},c,g(b.start_time))})});b&&d("BootloaderEvents").onBootload(function(a){a=d("BootloaderEventsPerf").computeBLData(a);var e=d("BootloaderEventsPerf").flattenData(a);c("CometBootloaderEventsTypedLoggerLite").log(babelHelpers["extends"]({},e,g(a.start_time)),{weight:b})})}g.initLogging=a}),98);
__d("CometIconWirelessSlashFilled.react",["CometSVGIcon.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){return h.jsx(c("CometSVGIcon.react"),babelHelpers["extends"]({viewBox:"0 0 24 24"},a,{children:h.jsx("path",{d:"M23.7805.2195c.2925.293.2925.768 0 1.061l-22.5 22.5C1.134 23.927.942 24 .75 24c-.192 0-.384-.073-.5305-.2195-.2925-.293-.2925-.768 0-1.061l12.1967947-12.1971509c-2.3773758-.1150468-4.79162015.7286756-6.6038447 2.5401009-.3905.3905-1.0235.3905-1.414 0-.3905-.3905-.3905-1.024 0-1.414 2.65728981-2.65728981 6.3696459-3.62280965 9.8005664-2.90852144l2.430738-2.43186193C11.7816792 4.58111626 6.15198938 5.65271062 2.27735 9.52735c-.3905.3905-1.0235.3905-1.414 0-.3905-.3905-.3905-1.0235 0-1.414 4.6714534-4.67191574 11.571522-5.78608437 17.3096457-3.34843552L22.7195.2195c.293-.2925.768-.2925 1.061 0zM12 18.5c.6905 0 1.25.5595 1.25 1.25S12.6905 21 12 21s-1.25-.5595-1.25-1.25.5595-1.25 1.25-1.25zm1.4175-4.81495c.9705.2455 1.8905.741 2.6485 1.499.3905.3905.3905 1.0235 0 1.414-.1955.1955-.451.293-.707.293-.256 0-.512-.0975-.707-.293-.7835333-.7835333-1.8301422-1.1445778-2.8581093-1.0880116L11.574 15.52855l1.8435-1.8435zm3.8154-3.8154c.848.4725 1.649 1.059 2.3685 1.779.391.39.391 1.023 0 1.414-.195.195-.451.293-.707.293-.2555 0-.5115-.098-.707-.293-.7285-.728-1.5575-1.291-2.439-1.7085zm2.1908-2.1908l1.4425-1.4425c.8.545 1.5615 1.168 2.2705 1.877.3905.3905.3905 1.0235 0 1.414-.1955.1955-.451.293-.707.293-.256 0-.5115-.0975-.707-.293-.5933333-.59333333-1.2283333-1.11861111-1.895162-1.57959491L19.4237 7.67885l1.4425-1.4425z"})}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometNetworkStatusToast",["fbt","ix","BaseToasterStateManager","CometIconWirelessSlashFilled.react","CometRelayEnvironmentFactory","NetworkStatus","TetraIcon.react","cometPushToast","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k=null;function l(a){a=a.online;var b=c("BaseToasterStateManager").getInstance();k!=null&&(b.expire(k),k=null);k=a?d("cometPushToast").cometPushToast({icon:j.jsx(c("TetraIcon.react"),{color:"positive",icon:d("fbicon")._(i("485124"),24)}),message:h._("Przywr\u00f3cono po\u0142\u0105czenie z Internetem.")},4e3,b):d("cometPushToast").cometPushToast({action:{label:h._("Od\u015bwie\u017c"),onPress:function(){d("CometRelayEnvironmentFactory").commitLocalUpdateForEachEnvironment(function(a,b,c){c.invalidateStore()})}},icon:j.jsx(c("TetraIcon.react"),{color:"disabled",icon:c("CometIconWirelessSlashFilled.react"),size:24}),message:h._("Jeste\u015b teraz w trybie offline.")},Infinity,b)}function a(){c("NetworkStatus").onChange(l)}g.subscribe=a}),98);
__d("SimplePageLoadLogger",["ODS","performance"],(function(a,b,c,d,e,f,g){"use strict";function a(){d("ODS").bumpEntityKey(1678,"www_client_navigations",h())}function h(){if(c("performance").navigation==null||c("performance").navigation.type==null)return"UNSUPPORTED";switch(c("performance").navigation.type){case c("performance").navigation.TYPE_NAVIGATE:return"NAVIGATE";case c("performance").navigation.TYPE_RELOAD:return"RELOAD";case c("performance").navigation.TYPE_BACK_FORWARD:return"BACK_FORWARD";case c("performance").navigation.TYPE_RESERVED:return"RESERVED";default:return"UNKNOWN"}}g.logPageNavigationType=a}),98);
__d("CometRootDeferredShared",["CometBootloaderLoggerUtil","CometErrorRoot.react","CometFullPageCompatRoot.react","CometNetworkStatusToast","CometVCTracker","CometVirtualCursorStatus","DeferredCookie","DetectBrokenProxyCache","ErrorGuard","JSScheduler","SimplePageLoadLogger","WebStorageMonster","cr:1201738","cr:1332233","cr:1516609","cr:1813330"],(function(a,b,c,d,e,f,g){"use strict";b("CometErrorRoot.react");b("CometFullPageCompatRoot.react");function a(a){var e=a.blLoggingCavalryFields,f=a.deferredCookies,g=a.userID;c("ErrorGuard").applyWithGuard(function(){return d("CometBootloaderLoggerUtil").initLogging(e)},null,[]);c("ErrorGuard").applyWithGuard(function(){return d("CometVirtualCursorStatus").initLogging()},null,[]);c("ErrorGuard").applyWithGuard(function(){return d("CometNetworkStatusToast").subscribe()},null,[]);c("ErrorGuard").applyWithGuard(function(){return d("SimplePageLoadLogger").logPageNavigationType()},null,[]);d("JSScheduler").scheduleSpeculativeCallback(function(){c("WebStorageMonster").schedule()});d("JSScheduler").scheduleSpeculativeCallback(function(){d("DetectBrokenProxyCache").run(g,"c_user")});b("cr:1201738")&&c("CometVCTracker").VisualCompletionTraceObserver.subscribe(function(a){a.interactionType==="INITIAL_LOAD"&&b("cr:1201738").init()});Object.keys(f).forEach(function(a){var b=f[a],d=b.expiration_for_js,e=b.first_party_only,g=b.path,h=b.secure;b=b.value;c("DeferredCookie").addToQueue(a,b,d,g,e,!1,h)});b("cr:1332233")&&c("ErrorGuard").applyWithGuard(function(){return b("cr:1332233")()},null,[]);b("cr:1516609")!=null&&c("ErrorGuard").applyWithGuard(function(){return b("cr:1516609").initSignalCollection()},null,[]);b("cr:1813330")&&c("ErrorGuard").applyWithGuard(function(){return b("cr:1813330").init()},null,[])}g.initDeferred=a}),98);
__d("CometRootMessengerDeferred",["CometRootDeferredShared"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("CometRootDeferredShared").initDeferred(a)}g.initDeferred=a}),98);
__d("CometOnBeforeUnloadDialog.react",["fbt","CometCardedDialog.react","CometTrackingNodeProvider.react","TetraButtonGroup.react","TetraText.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){var b=a.body,d=a.cancel,e=a.confirm,f=a.disabled;f=f===void 0?!1:f;var g=a.onClose,j=a.onCloseButtonPress,k=a.primaryAction,l=a.secondaryAction;a=a.title;var m=function(){k(),g()},n=function(){l(),g()};return i.jsx(c("CometTrackingNodeProvider.react"),{trackingNode:163,children:i.jsxs(c("CometCardedDialog.react"),{onClose:function(){j(),g()},testid:void 0,title:a,titleHorizontalAlignment:"start",withCloseButton:!0,children:[i.jsx("div",{className:"l9j0dhe7 dati1w0a f10w8fjw hv4rvrfc pybr56ya",children:i.jsx(c("TetraText.react"),{type:"body3",children:b})}),i.jsx("div",{className:"a8nywdso ihqw7lf3 rz4wbd8a jb3vyjys bkfpd7mw btwxx1t3 j83agx80",children:i.jsx(c("TetraButtonGroup.react"),{direction:"backward",paddingHorizontal:16,primary:{disabled:f,label:(a=e)!=null?a:h._("Potwierd\u017a"),onPress:m,testid:"CometOnBeforeUnloadDialogConfirmButton"},secondary:{disabled:f,label:(b=d)!=null?b:h._("Anuluj"),onPress:n,reduceEmphasis:!0,testid:"CometOnBeforeUnloadDialogCancelButton"}})})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometRouteActorToaster.react",["fbt","Actor","CometRelay","CometRouteActorToasterBlocklist","CometRouteActorToasterQuery.graphql","TetraProfilePhoto.react","TetraText.react","WebPixelRatio","cometPushToast","getTopMostRoute","promiseDone","react","requireDeferred","useCometRouterState","useCurrentRoute","useRouteReferrer"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=d("react");e=d("react");var k=e.useEffect,l=e.useRef,m=c("requireDeferred")("AcfToastImpressionFalcoEvent").__setRef("CometRouteActorToaster.react");function n(a,b){if(b)return j.jsx(c("TetraText.react"),{color:"primary",type:"body3",children:h._("Teraz wchodzisz w interakcj\u0119 jako {=your profile}",[h._param("=your profile",j.jsx(c("TetraText.react"),{type:"bodyLink3",children:h._("Tw\u00f3j profil")}))])});else return j.jsx(c("TetraText.react"),{color:"primary",type:"body3",children:h._("Teraz wchodzisz w interakcj\u0119 jako {actor}",[h._param("actor",j.jsx(c("TetraText.react"),{type:"bodyLink3",children:a}))])})}var o=i!==void 0?i:i=b("CometRouteActorToasterQuery.graphql");function a(){var a=d("CometRelay").useRelayEnvironment(),b=d("Actor").useActor(),e=b[0];b=c("useCometRouterState")();var f=c("useCurrentRoute")(),g=c("useRouteReferrer")(),h=l({actorID:g==null?void 0:g.actorID,tracePolicy:g==null?void 0:g.tracePolicy});g=c("CometRouteActorToasterBlocklist").route_trace_policies;var i=f==null?void 0:f.tracePolicy;g=g.includes(i);b=b!=null?c("getTopMostRoute")(b):null;f=f===b;var p=f&&!g;k(function(){var b,f=(b=h.current)==null?void 0:b.actorID,g=(b=h.current)==null?void 0:b.tracePolicy;if(f!=null&&f!==e&&p){b=function(a){var b;b=a==null?void 0:(b=a.viewer)==null?void 0:(b=b.actor)==null?void 0:b.name;if(b!=null){var e;e=(a==null?void 0:(e=a.viewer)==null?void 0:(e=e.actor)==null?void 0:e.__typename)==="User";a=a==null?void 0:(a=a.viewer)==null?void 0:(a=a.actor)==null?void 0:(a=a.toast_icon)==null?void 0:a.uri;a=a!=null?j.jsx(c("TetraProfilePhoto.react"),{shape:"circle",size:32,source:{uri:a}}):null;b=n(b,e);d("cometPushToast").cometPushToast({icon:a,message:b});m.onReady(function(a){a=a.log;a(function(){var a;return{destination:(a=i)!=null?a:"comet.app",destination_type:"comet_route",source:g,source_type:"comet_route",source_userid:f}})})}};var k={scale:d("WebPixelRatio").get()};c("promiseDone")(d("CometRelay").fetchQuery(a,o,k).toPromise(),b)}h.current={actorID:e,tracePolicy:i}},[e,i,a,p]);return null}g["default"]=a}),98);
__d("CometUncaughtError.react",["fbt","CometContentArea.react","NullStateGeneral","TetraNullState.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(){return i.jsx("div",{className:"k4urcfbm poy2od1o taijpn5t nznu9b0o j83agx80 bp9cbjyn",children:i.jsx(c("CometContentArea.react"),{verticalAlign:"middle",children:i.jsx(c("TetraNullState.react"),{headline:h._("Przepraszamy, wyst\u0105pi\u0142 b\u0142\u0105d :("),icon:c("NullStateGeneral")})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometToasterView_DO_NOT_USE.react",["BaseContextualLayerAnchorRoot.react","BasePortal.react","BaseToastAnimationInternal.react","BaseToasterView.react","gkx","react","stylex","useToasterStateManager"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useEffect,j=b.useState,k={list:{display:"j83agx80",flexDirection:"cbu4d94t",listStyle:"p7hjln8o"},root:{bottom:"i09qtzwb",display:"j83agx80",end:"n7fi1qx3",position:"poy2od1o",start:"j9ispegn",zIndex:"kavbgo14"},rootBlue:{zIndex:"guygq49l"},rootWorkplaceLegacy:{zIndex:"lidd1b6n"},toast:{paddingTop:"discj3wi",paddingEnd:"hv4rvrfc",paddingBottom:"ihqw7lf3",paddingStart:"dati1w0a"}},l={center:{justifyContent:"taijpn5t"},start:{justifyContent:"jifvfom9"}};function a(a){var b=a.align;b=b===void 0?"start":b;var d=a.filterToasts;a=a.maxVisible;a=a===void 0?1:a;var e=c("useToasterStateManager")(),f=j(function(){return e.getEmptyState()}),g=f[0],m=f[1];i(function(){var a=e.registerView(m,0);return a.remove},[e]);return h.jsx(c("BasePortal.react"),{target:document.body,xstyle:[k.root,c("gkx")("708253")?null:c("gkx")("1341692")?k.rootWorkplaceLegacy:k.rootBlue,l[b]],children:h.jsx(c("BaseContextualLayerAnchorRoot.react"),{children:h.jsx(c("BaseToasterView.react"),{className:c("stylex")(k.list),filterToasts:d,maxVisible:a,toasterState:g,children:function(a,b,d,e){return h.jsx(c("BaseToastAnimationInternal.react"),{expired:d,id:b,position:e,xstyle:k.toast,children:a},e)}})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("GhlTestUbtFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1942319");c=b("FalcoLoggerInternal").create("ghl_test_ubt",a);e.exports=c}),null);
__d("CometGHLTestUBT",["GhlTestUbtFalcoEvent","JSScheduler","ghlTestUBT"],(function(a,b,c,d,e,f,g){"use strict";function a(){d("JSScheduler").scheduleLoggingPriCallback(function(){c("ghlTestUBT")(function(a){return c("GhlTestUbtFalcoEvent").log(function(){return{ubt:a}})})})}g["default"]=a}),98);
__d("ErrorSetup",["fb-error"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("fb-error").ErrorSetup}),98);
__d("JavascriptWebErrorFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1828905");c=b("FalcoLoggerInternal").create("javascript_web_error",a);e.exports=c}),null);
__d("ErrorTransport",["JavascriptWebErrorFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("JavascriptWebErrorFalcoEvent").log(function(){return a})}g.log=a}),98);
__d("CometErrorLogging",["ClientConsistency","Env","ErrorGuard","ErrorSetup","ErrorTransport","JSErrorLoggingConfig","SiteData","WebSession"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("ErrorGuard").skipGuardGlobal(c("Env").nocatch);b=a;if(c("JSErrorLoggingConfig").sampleWeight!=null){c("ErrorSetup").setup({additional_client_revisions:c("ClientConsistency").getAdditionalRevisions(),appId:c("JSErrorLoggingConfig").appId,cavalry_lid:b,client_revision:c("SiteData").client_revision,extra:c("JSErrorLoggingConfig").extra,loggingFramework:"comet",push_phase:c("SiteData").push_phase,report_source:c("JSErrorLoggingConfig").report_source,report_source_ref:c("JSErrorLoggingConfig").report_source_ref,sample_weight:(a=c("JSErrorLoggingConfig").sampleWeight)!=null?a:0,script_path:"/comet",server_revision:c("SiteData").server_revision,spin:c("SiteData").spin,web_session_id:d("WebSession").getId()},d("ErrorTransport").log)}}c("ErrorSetup").preSetup();g.init=a}),98);
__d("CometPixelRatioUpdater",["Cookie","Run"],(function(a,b,c,d,e,f,g){"use strict";var h="dpr";function i(a){c("Cookie").set(h,String(a))}function j(){c("Cookie").clear(h)}function k(){window.devicePixelRatio!==1?i(window.devicePixelRatio):j()}function a(){d("Run").onBeforeUnload(k,!1),"onpagehide"in window&&window.addEventListener("pageHide",k)}g.startDetecting=a}),98);
__d("WebBrowserDimensionsTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:WebBrowserDimensionsLoggerConfig")}),null);
__d("CometBrowserDimensionsLogger",["SiteData","WebBrowserDimensionsTypedLoggerLite","getViewportDimensions"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function i(){h===null&&(h=c("getViewportDimensions")());return h}function a(a){var b,d=i();b={client_hint_width:a==null?void 0:a.clientHintWidth,pixel_ratio:(b=window.devicePixelRatio)!=null?b:1,screen_x:window.screen.width,screen_y:window.screen.height,server_pixel_ratio:c("SiteData").pr,server_viewport_x:a==null?void 0:a.viewportWidth,server_viewport_y:a==null?void 0:a.viewportHeight,viewport_x:d.width,viewport_y:d.height};window.navigator&&window.navigator.hardwareConcurrency&&(b.cpu_cores_count=window.navigator.hardwareConcurrency);if(window.innerWidth>0&&window.outerWidth>0){a=Math.round(window.outerWidth/window.innerWidth*100)/100;b.zoom_ratio=a}if(window.getComputedStyle&&document.documentElement!=null){d=window.getComputedStyle(document.documentElement);d!=null&&(b.document_font_size=d.fontSize)}c("WebBrowserDimensionsTypedLoggerLite").log(b)}g.init=a}),98);
__d("MWChatMultitabCookieWriter.bs",["DeferredCookie","MWChatThreadId.bs","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a){var c=a.chatHeads.map(function(a){return{i:b("MWChatThreadId.bs").serializeFuture(a)}});a=a.openTabsState;var d;if(a.length!==1)d=void 0;else{a=a[0];a=a.threadID;d=a?b("MWChatThreadId.bs").serializeFuture(a._0):void 0}a=JSON.stringify({t3:c,utc3:Date.now(),lm3:d,v:1});a!==void 0?b("DeferredCookie").addToQueue("presence","C"+a,0,"",!1,!1,!0):b("recoverableViolation")("Failed to serialize cookie","messenger_comet")}c=1;f.version=c;f.write=a}),null);
__d("AvailableListState",[],(function(a,b,c,d,e,f){a=Object.freeze({OFFLINE:0,IDLE:1,ACTIVE:2,MOBILE:3});f["default"]=a}),66);
__d("PresenceStatusProviderSubscription",["AvailableListState","CometHomeContactsConfig","CometRelay","CurrentUser","LogHistory","PresenceStatusProviderSubscription_ContactProfilesQuery.graphql","PresenceStatusProviderSubscription_PresenceStatusChatVisibilityQuery.graphql","PresenceStatusProviderSubscription_rankings.graphql","WebPixelRatio","gkx","promiseDone","recoverableViolation","relay-runtime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=c("requireDeferred")("FBMqttChannel").__setRef("PresenceStatusProviderSubscription"),l=c("requireDeferred")("MessengerMQTTPresence").__setRef("PresenceStatusProviderSubscription"),m=Object.assign.apply(Object,[{}].concat(Object.entries(c("AvailableListState")).map(function(a){var b,c=a[0];a=a[1];return b={},b[String(a)]=c,b}))),n=h!==void 0?h:h=b("PresenceStatusProviderSubscription_PresenceStatusChatVisibilityQuery.graphql"),o=i!==void 0?i:i=b("PresenceStatusProviderSubscription_ContactProfilesQuery.graphql");function p(a){var b=null,c=k.onReady(function(c){c.subscribe("/legacy_web",function(b){var c=JSON.parse(b);c.type==="privacy_changed"&&a.commitUpdate(function(a){a=a.getRoot();if(a==null)return;a=a.getLinkedRecord("viewer");if(a==null)return;a.setValue(((a=c.data)==null?void 0:a.visibility)===!0,"chat_visibility")})}),b=function(){return c.unsubscribeAll("/legacy_web")}});return{remove:function(){c.remove(),b!=null&&b()}}}function q(a,b,c,d,e){var f=null,g=l.onReady(function(g){g.subscribe({reset:function(){var f=b.current,g={};Object.keys(f).forEach(function(a){delete g[a]});b.current=g;w(a,b.current,c,d,e)},setMultiFromMQTT:function(f){var g=b.current,h=babelHelpers["extends"]({},g);f.forEach(function(a){h[a.u]={last_active_time:a.l,status:a.p}});b.current=h;w(a,b.current,c,d,e)}}),f=function(){return g.unsubscribe()}});return{remove:function(){g.remove(),f!=null&&f()}}}function r(a,b,c,e,f){var g,h=d("relay-runtime").getRequest(n);h=d("relay-runtime").createOperationDescriptor(h,{});h=a.lookup(h.fragment);g=(g=h.data)==null?void 0:g.viewer;var i=typeof g==="object"?g==null?void 0:g.chat_visibility:null;e.current=!!i;g=a.subscribe(h,function(d){d=d.data;d=d==null?void 0:d.viewer;if(typeof d!=="object"||d==null)return;var g=d==null?void 0:d.presence_view_side_settings;if(typeof g==="object"&&g!=null&&g.has_converted_to_view_side_settings===!0)return;g=d.chat_visibility;i!=null&&g!==i&&w(a,b.current,c,e,f);i=g});return g}var s={height:36,scale:d("WebPixelRatio").get(),width:36},t=function(a,b,e){if(b.size===0)return;c("promiseDone")(d("CometRelay").fetchQuery(e,o,{ids:Array.from(b),scale:d("WebPixelRatio").get()},c("gkx")("1820749")?{fetchPolicy:"store-or-network"}:void 0).toPromise().then(function(b){var d=(b==null?void 0:(b=b.viewer)==null?void 0:b.chat_sidebar_contact_nodes)||[];e.commitUpdate(function(b){d.forEach(function(d){var e,f=d==null?void 0:d.id;if(f==null)return;var g=b.get(f);g==null&&(g=b.create(f,"User"));var h=d==null?void 0:d.name;if(h==null)return c("recoverableViolation")("ContactProfilesQuery return empty name for user "+f,"messenger_comet");g.setValue(h,"name");h=g.getOrCreateLinkedRecord("profile_picture","Image",s);e=d==null?void 0:(e=d.profile_picture)==null?void 0:e.uri;if(e==null)return c("recoverableViolation")("ContactProfilesQuery return empty profileUri for user "+f,"messenger_comet");h.setValue(d==null?void 0:(e=d.profile_picture)==null?void 0:e.uri,"uri");g.setLinkedRecord(h,"profile_picture",s);a.push(g)}),v(b,a)})}))},u=function(a,b,d,e){a.commitUpdate(function(f){if(d==null)return;var g=new Set(Object.keys(b).filter(function(a){return c("CurrentUser").getID()!==a&&((a=b[a])==null?void 0:a.status)===2})),h=d.filter(function(a){var c=a.buddy_id;a=a.status;return a==null||c==null?!1:((c=e.current?(c=b[c])==null?void 0:c.status:0)!=null?c:0)===a}).map(function(a){a=(a=a.user)==null?void 0:a.id;if(a==null)return null;g["delete"](a);return f.get(a)}).filter(Boolean);g.size>0&&(g.forEach(function(a){var b=f.get(a);if(b!=null&&b.getValue("name")!=null){var c=b.getLinkedRecord("profile_picture",s);c!=null&&c.getValue("uri")!=null&&(h.push(b),g["delete"](a))}}),t(h,g,a));v(f,h)})};function v(a,b){d("LogHistory").getInstance("messenger-comet").log("updateChatSidebarContacts",b.length);a=a.getRoot().getLinkedRecord("viewer");if(a==null){c("recoverableViolation")("Viewer should not be null here, something has gone horribly wrong","messenger_web_product");return}a.setLinkedRecords(b,"chat_sidebar_contacts",{count:c("CometHomeContactsConfig").numContactsToFetch})}function w(a,b,c,d,e){a.commitUpdate(function(a){var e=a.getRoot();if(e==null)return;e=e.getLinkedRecord("viewer");if(e==null)return;var f=e.getLinkedRecord("presence_view_side_settings"),g=f!=null&&f.getValue("has_converted_to_view_side_settings")===!0||e.getValue("chat_visibility")===!0;f=e.getLinkedRecord("actor");f!=null&&g?f.setValue("ACTIVE","availability"):f!=null&&f.setValue("OFFLINE","availability");d.current=g;e=Object.keys(b);e.forEach(function(c){var d,e;d=(d=b[c])==null?void 0:d.status;e=(e=b[c])==null?void 0:e.last_active_time;d=d==null?null:m[String(d)];var f=a.get(c);f==null&&d==="ACTIVE"&&(f=a.create(c,"User"));f!=null&&(f.setValue(d==="ACTIVE"&&g?d:null,"availability"),!g?f.setValue(null,"last_active_time"):e!==0&&e!=null&&f.setValue(e,"last_active_time"))});c()}),u(a,b,e,d)}a={init:function(a,c,e,f,g){g=g!=null?g.map(function(a){return d("CometRelay").readInlineData(j!==void 0?j:j=b("PresenceStatusProviderSubscription_rankings.graphql"),a)}):null;var h=p(a),i=q(a,c,e,f,g),k=r(a,c,e,f,g);return{remove:function(){i.remove(),h.remove(),k.dispose()}}}};g["default"]=a}),98);
__d("PresenceStatusProviderSubscriptionComponent.react",["CometRelay","PresenceStatusProviderSubscription","PresenceStatusProviderSubscriptionComponentQuery.graphql","WebPixelRatio","qex","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react").useEffect,j=500,k=function(){var a;return d("CometRelay").useLazyLoadQuery(h!==void 0?h:h=b("PresenceStatusProviderSubscriptionComponentQuery.graphql"),{count:(a=c("qex")._("502"))!=null?a:j,scale:d("WebPixelRatio").get()})};function a(a){var b=a.chatVisibilityRef,e=a.presenceInformer,f=a.presenceMap;a=k();var g=(a=a==null?void 0:(a=a.viewer)==null?void 0:a.chat_sidebar_contact_rankings)!=null?a:null,h=d("CometRelay").useRelayEnvironment();i(function(){var a=c("PresenceStatusProviderSubscription").init(h,f,e,b,g);return function(){a.remove()}},[h,e,f,g,b]);return null}g["default"]=a}),98);
__d("CometRelayEF",["Bootloader","BootloaderEvents","ClientConsistencyEventEmitter","CometSSREntrypoint","cometAsyncFetch","gkx","performanceAbsoluteNow","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(a,b){if(!c("gkx")("1334580"))return;a=d("CometSSREntrypoint").processRootEntryPoint(a,b);var e=[];a.forEach(function(a){a=a.name;h.has(a)||(e.push(a),d("BootloaderEvents").notifyHasteResponseEFStart("relay_3d",a))});if(e.length===0)return;var f=c("performanceAbsoluteNow")(),g=c("cometAsyncFetch")("/ajax/relay-ef/",{data:{queries:e},method:"POST"}).then(function(a){return{fetchPredictionsEnd:c("performanceAbsoluteNow")(),fetchPredictionsStart:f,payload:a}});e.forEach(function(a){return h.set(a,g)})}function a(a,b){if(!c("gkx")("1334580"))return;var e=c("performanceAbsoluteNow")();i(a,b);a=d("CometSSREntrypoint").processRootEntryPoint(a,b);a.forEach(function(a){var b=a.name,f=h.get(b);f&&f!==!0&&c("promiseDone")(f,function(a){var f=a.fetchPredictionsEnd,g=a.fetchPredictionsStart;a=a.payload;a!=null&&typeof a==="object"&&(c("Bootloader").loadPredictedResourceMap(a.predictions[b],{onLog:function(a){return d("BootloaderEvents").notifyHasteResponseEF("relay_3d",b,{fetchPredictionsEnd:f,fetchPredictionsStart:g,fetchRsrcsStart:e,tierOne:a})}},a.consistency.rev),c("ClientConsistencyEventEmitter").emit("newEntry",a.consistency))});h.set(a.name,!0)})}g.fetchPredictions=i;g.fetchPredictedResources=a}),98);
__d("RTWebCallBlockSettingHooks",["CometRelay","DateConsts","RTWebCallBlockSettingHooksQuery.graphql","RTWebCallBlockedSettingSubscription","RTWebPreCallContext","ServerTime","gkx","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h;e=d("react");var i=e.useContext,j=e.useEffect,k=e.useState,l=6e4,m=h!==void 0?h:h=b("RTWebCallBlockSettingHooksQuery.graphql"),n=function(a,b){return function(c){c=c.getRoot();if(c==null)return;c=c.getLinkedRecord("viewer");if(c==null)return;c.setValue(b,a)}};function o(a){return a===-1?a:(a||0)*d("DateConsts").MS_PER_SEC}function p(){var a=d("CometRelay").useRelayEnvironment(),b=d("CometRelay").getActorID(a),e=k(0),f=e[0],g=e[1];j(function(){var e=d("CometRelay").fetchQuery(a,m,{},c("gkx")("1820749")?{fetchPolicy:"store-or-network"}:void 0).toPromise().then(function(a){a=a==null?void 0:a.viewer;a!=null&&g(o(a.call_blocked_until))});c("promiseDone")(e);var f=d("RTWebCallBlockedSettingSubscription").subscribe(a,{viewer_id:b},function(b){b=b==null?void 0:b.rtweb_call_blocked_setting_subscribe;b!=null&&(g(o(b.call_blocked_until)),a.commitUpdate(n("call_blocked_until",b.call_blocked_until)))});return function(){f.dispose()}},[a,b]);return f}function q(){var a=p(),b=d("ServerTime").getMillis(),c=a<0,e=a>b;b=k(c||e);var f=b[0],g=b[1];(c||e)!==f&&g(c||e);j(function(){if(e){var b=window.setInterval(function(){a<=d("ServerTime").getMillis()&&(g(!1),window.clearInterval(b))},l);return function(){window.clearInterval(b)}}},[a,e]);return f}function a(){var a=i(c("RTWebPreCallContext")),b=q();j(function(){a!=null&&a.callInviteModel.startListening({callsBlocked:b})},[a,b])}g.useCallBlockSettingValue=p;g.useHasCallsBlocked=q;g.useCallBlockSetting=a}),98);
__d("showDesktopNotification",["MessengerDesktopNotificationPermissions","MessengerDesktopNotifications","ZenonUserActionLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=8e3;function a(){return function(a){var b=a.acceptCall,e=a.body,f=a.icon;a=a.title;var g={body:e,closeTime:h,icon:f,onClick:function(){d("ZenonUserActionLogger").logClick({component:"browser_notification",surface:"desktop_notification"}),window.focus(),b({trigger:"desktop_notification"})},onShow:function(){d("ZenonUserActionLogger").logImpression({component:"browser_notification",surface:"desktop_notification"})},title:a};if(d("MessengerDesktopNotifications").checkPermission()===c("MessengerDesktopNotificationPermissions").DEFAULT){d("MessengerDesktopNotifications").requestPermission(function(){d("MessengerDesktopNotifications").showNotification(g)});return}d("MessengerDesktopNotifications").showNotification(g)}}g["default"]=a}),98);
__d("RTWebCallInviteDesktopNotification.react",["fbt","RTWebPreCallHooks","ZenonUsersHooks","react","showDesktopNotification","usePrevious"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){a=a.invite;return(a==null?void 0:a.type)==="ringing"?i.jsx(j,{invite:a}):null}a.displayName=a.name+" [from "+f.id+"]";function j(a){a=a.invite;var b=c("showDesktopNotification")(),e=c("usePrevious")(a.ringID),f=d("RTWebPreCallHooks").useAcceptCallCallback(),g=d("ZenonUsersHooks").useZenonUser(a.inviterID),h=a.requestingVideo,i=a.participants.length>1;if(e!==a.ringID&&g!=null){b({acceptCall:f,body:l(g.shortName),icon:(e=g.profilePictureUrl)!=null?e:null,title:k(h,i)})}return null}function k(a,b){if(!b)return a?h._("Przychodz\u0105ca rozmowa wideo"):h._("Po\u0142\u0105czenie przychodz\u0105ce");else return a?h._("Przychodz\u0105ca grupowa rozmowa wideo"):h._("Przychodz\u0105ca rozmowa grupowa")}function l(a){return h._("{caller name} dzwoni do Ciebie. Kliknij, aby odpowiedzie\u0107.",[h._param("caller name",a)])}g["default"]=a}),98);
__d("ZenonDialogContext",["emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";a=d("react");b=a.createContext({hide:c("emptyFunction"),hideAll:c("emptyFunction"),hideByID:c("emptyFunction"),show:c("emptyFunction"),showByID:c("emptyFunction"),toggle:c("emptyFunction")});e=b;g["default"]=e}),98);
__d("useRTWebIncomingCallDialog",["fbt","ix","RTWebPreCallContext","ZenonDialogContext","ZenonUserActionLogger","cr:1568669","deferredLoadComponent","emptyFunction","fbicon","react","requireDeferred"],(function(a,b,c,d,e,f,g,h,i){"use strict";e=d("react");var j=e.useCallback,k=e.useContext,l=c("deferredLoadComponent")(c("requireDeferred")("RTWebCometIncomingCallContent.react").__setRef("useRTWebIncomingCallDialog")),m=c("deferredLoadComponent")(c("requireDeferred")("RTWebCometCallDialog.react").__setRef("useRTWebIncomingCallDialog")),n=d("react"),o=b("cr:1568669")?b("cr:1568669").addPoint:c("emptyFunction");function a(){var a=k(c("ZenonDialogContext")),b=a.hide,e=a.show;a=k(c("RTWebPreCallContext"));var f=a?a.callInviteModel:null;return j(function(a){var c,g=a.inviterID,j=a.isVideoCall,k=a.onAccept,q=a.onDecline;a=a.participantIDs;d("ZenonUserActionLogger").logImpression({surface:"incoming_call_dialog"});o(64225282,"render_dialog",{instanceKey:+(f==null?void 0:(c=f.getCurrentInvite())==null?void 0:c.ringID)});e(n.jsx(m,{acceptIcon:j?d("fbicon")._(i("493173"),16):d("fbicon")._(i("558160"),16),acceptLabel:h._("Akceptuj"),acceptTestid:"answerCallButton",body:n.jsx(l,{inviterID:g,isVideoCall:j,participantIDs:a}),declineLabel:h._("Odrzu\u0107"),onClose:function(a){d("ZenonUserActionLogger").logClick({component:a?"accept_button":"decline_button",surface:"incoming_call_dialog"});b();return a?k():q()},title:p(j,a.length>1)}));return{dismiss:b}},[f,b,e])}function p(a,b){if(!b)return a?h._("Przychodz\u0105cy czat wideo"):h._("Po\u0142\u0105czenie przychodz\u0105ce");else return a?h._("Przychodz\u0105ca grupowa rozmowa wideo"):h._("Przychodz\u0105ce po\u0142\u0105czenie grupowe")}g["default"]=a}),98);
__d("RTWebIncomingUnsupportedBrowserDialogWrapper.react",["cr:230"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:230")}),98);
__d("useRTWebIncomingUnsupportedBrowserDialog",["RTWebIncomingUnsupportedBrowserDialogWrapper.react","ZenonDialogContext","ZenonUserActionLogger","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useCallback,j=b.useContext;function a(){var a=j(c("ZenonDialogContext")),b=a.hide,e=a.show;return i(function(a){d("ZenonUserActionLogger").logImpression({surface:"unsupported_browser_dialog"});a=babelHelpers["extends"]({},a,{hide:b});e(h.jsx(c("RTWebIncomingUnsupportedBrowserDialogWrapper.react"),babelHelpers["extends"]({},a)));return{dismiss:b}},[b,e])}g["default"]=a}),98);
__d("useRTWebMissedCallDialog",["fbt","ix","CometCardedDialogLoadingState.react","CometPlaceholder.react","JSResourceForInteraction","ZenonDialogContext","ZenonUserActionLogger","fbicon","lazyLoadComponent","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");b=d("react");var k=b.useCallback,l=b.useContext,m=c("lazyLoadComponent")(c("JSResourceForInteraction")("RTWebCometMissedCallContent.react").__setRef("useRTWebMissedCallDialog")),n=c("lazyLoadComponent")(c("JSResourceForInteraction")("RTWebCometCallDialog.react").__setRef("useRTWebMissedCallDialog"));function a(){var a=l(c("ZenonDialogContext")),b=a.hide,e=a.show;return k(function(a){var f=a.inviterID,g=a.isVideoCall,k=a.onCallback,l=a.participantIDs;a=a.timeMissed;d("ZenonUserActionLogger").logImpression({surface:"missed_call_dialog"});e(j.jsx(c("CometPlaceholder.react"),{fallback:j.jsx(c("CometCardedDialogLoadingState.react"),{}),children:j.jsx(n,{acceptIcon:g?d("fbicon")._(i("493173"),16):d("fbicon")._(i("558160"),16),acceptLabel:h._("Oddzwo\u0144"),body:j.jsx(m,{inviterID:f,isRoomCall:!1,isVideoCall:g,participantIDs:l,timeMissed:a}),declineLabel:h._("Zamknij"),onClose:function(a){d("ZenonUserActionLogger").logClick({component:a?"call_back":"close_dialog",surface:"missed_call_dialog"});a&&d("ZenonUserActionLogger").logClick({component:"start_call_button",surface:"missed_call_dialog"});b();return a?k():void 0},title:o(g,l.length>1)})}));return{dismiss:b}},[b,e])}function o(a,b){if(!b)return a?h._("Nieodebrana rozmowa wideo"):h._("Nieodebrane po\u0142\u0105czenie");else return a?h._("Nieodebrana grupowa rozmowa wideo"):h._("Nieodebrane rozmowa grupowa")}g["default"]=a}),98);
__d("RTWebCometRoomIncomingCallDialog.entrypoint",["JSResourceForInteraction","RTWebCometRoomIncomingCallDialog_DisclaimerQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{queryReference:{parameters:b("RTWebCometRoomIncomingCallDialog_DisclaimerQuery$Parameters"),variables:{nuxID:8259}}}}},root:c("JSResourceForInteraction")("RTWebCometRoomIncomingCallDialogContainer.react").__setRef("RTWebCometRoomIncomingCallDialog.entrypoint")};g["default"]=a}),98);
__d("useRoomIncomingCallDialog",["CometPlaceholder.react","CometRelay","RTWebCometRoomIncomingCallDialog.entrypoint","VideoChatLinksUserActionsMultiplexLogger","ZenonDialogContext","react","useCometRelayEntrypointContextualEnvironmentProvider"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useCallback,j=b.useContext;function a(){var a=j(c("ZenonDialogContext")),b=a.hide,e=a.show,f=c("useCometRelayEntrypointContextualEnvironmentProvider")();return i(function(a){var g=a.inviterID,i=a.linkUrl,j=a.onAccept,k=a.onDecline,l=a.roomName;a=a.sender;new(c("VideoChatLinksUserActionsMultiplexLogger"))().setSurface("vcl_meetups_notification").setEvent("room_ringback_received").setVideoCallLinkURLRaw(i).log();var m=d("CometRelay").loadEntryPoint(f,c("RTWebCometRoomIncomingCallDialog.entrypoint"),{});e(h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(d("CometRelay").EntryPointContainer,{entryPointReference:m,props:{inviterID:g,linkUrl:i,onAccept:j,onDecline:k,roomName:l,sender:a}})}));return{dismiss:b}},[f,b,e])}g["default"]=a}),98);
__d("useRoomMissedCallDialog",["fbt","ix","CometCardedDialogLoadingState.react","CometPlaceholder.react","JSResourceForInteraction","VideoChatLinksUserActionsMultiplexLogger","ZenonDialogContext","fbicon","lazyLoadComponent","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");b=d("react");var k=b.useCallback,l=b.useContext,m=c("lazyLoadComponent")(c("JSResourceForInteraction")("RTWebCometMissedCallContent.react").__setRef("useRoomMissedCallDialog")),n=c("lazyLoadComponent")(c("JSResourceForInteraction")("RTWebCometCallDialog.react").__setRef("useRoomMissedCallDialog"));function a(){var a=l(c("ZenonDialogContext")),b=a.hide,e=a.show;return k(function(a){var f=a.inviterID,g=a.linkUrl,k=a.onCallback,l=a.participantIDs,o=a.roomName;a=a.timeMissed;new(c("VideoChatLinksUserActionsMultiplexLogger"))().setSurface("vcl_meetups_notification").setEvent("room_ringback_missed").setVideoCallLinkURLRaw(g).log();e(j.jsx(c("CometPlaceholder.react"),{fallback:j.jsx(c("CometCardedDialogLoadingState.react"),{}),children:j.jsx(n,{acceptIcon:d("fbicon")._(i("493173"),16),acceptLabel:h._("Do\u0142\u0105cz"),body:j.jsx(m,{inviterID:f,isRoomCall:!0,isVideoCall:!1,participantIDs:l,timeMissed:a}),declineLabel:h._("Zamknij"),onClose:function(a){a?(new(c("VideoChatLinksUserActionsMultiplexLogger"))().setSurface("vcl_meetups_notification").setEvent("room_ringback_accepted").setVideoCallLinkURLRaw(g).log(),k()):new(c("VideoChatLinksUserActionsMultiplexLogger"))().setSurface("vcl_meetups_notification").setEvent("room_ringback_missed_dialog_dismissed").setVideoCallLinkURLRaw(g).log(),b()},title:h._("Nieodebrane po\u0142\u0105czenie z pokoju {room name}",[h._param("room name",o)])})}));return{dismiss:b}},[b,e])}g["default"]=a}),98);
__d("useZenonDialogController",["react","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useEffect,i=b.useState;function a(a,b){var d=i(null),e=d[0],f=d[1],g=c("usePrevious")(a);h(function(){if((a==null?void 0:a.ringID)===(g==null?void 0:g.ringID)&&(a==null?void 0:a.type)===(g==null?void 0:g.type))return;e&&(e.dismiss(),f(null));if(a===null)return;f(b())},[e,a,g,b]);return e}g["default"]=a}),98);
__d("RTWebCometCallInviteDialogs.react",["Actor","RTWebPreCallContext","RTWebPreCallHooks","ServerTime","StartVideoChatLinkCall","qex","react","useRTWebIncomingCallDialog","useRTWebIncomingUnsupportedBrowserDialog","useRTWebMissedCallDialog","useRoomIncomingCallDialog","useRoomMissedCallDialog","useZenonDialogController"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useContext;function a(a){var b=a.invite;a=d("Actor").useActor();var e=a[0];a=h(c("RTWebPreCallContext"));var f=c("useRTWebIncomingCallDialog")(),g=c("useRoomIncomingCallDialog")(),i=c("useRTWebMissedCallDialog")(),j=c("useRoomMissedCallDialog")(),k=c("useRTWebIncomingUnsupportedBrowserDialog")(),l=d("RTWebPreCallHooks").useAcceptCallCallback(),m=d("RTWebPreCallHooks").useStartCallCallback(),n=a?a.callInviteModel:null;c("useZenonDialogController")(b,function(){if(b===null||n==null)return null;if(b.context.type==="room"){var a,h=b.context.room;a=(a=c("qex")._("1968272"))!=null?a:!1;if(a)switch(b.type){case"ringing":return g({inviterID:b.inviterID,linkUrl:h.linkHash,onAccept:function(){d("StartVideoChatLinkCall").startCall(h.linkHash,!0,!0)},onDecline:function(){n.decline("IgnoreCall")},roomName:h.roomName,sender:h.sender});case"missed":return j({inviterID:b.inviterID,linkUrl:h.linkHash,onCallback:function(){d("StartVideoChatLinkCall").startCall(h.linkHash,!0,!0),n.dismiss()},participantIDs:b.participants,roomName:h.roomName,timeMissed:new Date(d("ServerTime").getMillis())});case"unsupported_browser":return k({inviterID:b.inviterID,isVideoCall:b.requestingVideo,onClose:function(){n.dismiss()},participantIDs:b.participants,threadType:3});default:return null}else switch(b.type){case"ringing":return g({inviterID:b.inviterID,linkUrl:h.linkHash,onAccept:function(){d("StartVideoChatLinkCall").startCall(h.linkHash,!0,!0)},onDecline:function(){n.decline("IgnoreCall")},roomName:h.roomName,sender:h.sender});case"missed":return j({inviterID:b.inviterID,linkUrl:h.linkHash,onCallback:function(){d("StartVideoChatLinkCall").startCall(h.linkHash,!0,!0),n.dismiss()},participantIDs:b.participants,roomName:h.roomName,timeMissed:new Date(d("ServerTime").getMillis())});default:return null}}switch(b.type){case"ringing":return f({inviterID:b.inviterID,isVideoCall:b.requestingVideo,onAccept:function(){l({trigger:"comet_incoming_dialog_accept_button"})},onDecline:function(){n.decline("IgnoreCall")},participantIDs:b.participants});case"missed":if(b.context.type==="thread"){var o=b.context.thread;return i({inviterID:b.inviterID,isVideoCall:b.requestingVideo,onCallback:function(){m({existingCall:null,invitees:[b.inviterID].concat(b.participants.filter(function(a){return a!==e})),mediaType:b.requestingVideo?"video":"audio",thread:o,trigger:"comet_missed_call_dialog"}),n.dismiss()},participantIDs:b.participants,timeMissed:new Date(d("ServerTime").getMillis())})}return null;case"unsupported_browser":return k({inviterID:b.inviterID,isVideoCall:b.requestingVideo,onClose:function(){n.dismiss()},participantIDs:b.participants,threadType:b.context.type==="thread"?b.context.thread.type:2});default:return null}});return null}g["default"]=a}),98);
__d("useZenonRingTone",["RTCSounds","Sound","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useEffect,i=[d("RTCSounds").ringtone_mp3_url,d("RTCSounds").ringtone_ogg_url];function a(a){a===void 0&&(a=!1),h(function(){if(a){d("Sound").play(i,null,!0);return function(){d("Sound").stop(i)}}},[a])}g["default"]=a}),98);
__d("ZenonCallInviteRingtone.react",["useZenonRingTone"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.invite;c("useZenonRingTone")((a==null?void 0:a.type)==="ringing");return null}g["default"]=a}),98);
__d("useDocumentTitleBlink",["DocumentTitle","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useEffect;function a(a){h(function(){if(a==null)return;var b=c("DocumentTitle").blink(a);return function(){b.stop()}},[a])}g["default"]=a}),98);
__d("ZenonCallInviteTitleBlinking.react",["fbt","ZenonUsersHooks","react","useDocumentTitleBlink"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){a=a.invite;return a!==null&&a.type==="ringing"&&a.inviterID!=null?i.jsx(j,{inviterID:a.inviterID}):null}a.displayName=a.name+" [from "+f.id+"]";function j(a){a=a.inviterID;a=d("ZenonUsersHooks").useZenonUser(a);c("useDocumentTitleBlink")(a?h._("Dzwoni {name}",[h._param("name",a.shortName)]):null);return null}g["default"]=a}),98);
__d("useZenonDialogSetters",["react"],(function(a,b,c,d,e,f,g){"use strict";d("react");var h=d("react").useMemo;function a(a,b){return h(function(){return{hide:function(){a(null)},hideAll:function(){a(null),b([])},hideByID:function(a){b(function(b){return b.filter(function(b){return b.key!==a})})},show:a,showByID:function(a,c){b(function(b){var d=b.findIndex(function(b){return b.key===a}),e={key:a,node:c};if(d===-1)return[].concat(b,[e]);else return[].concat(b.slice(0,d),b.slice(d+1),[e])})},toggle:function(b){b===void 0&&(b=!1),b||a(null)}}},[a,b])}g["default"]=a}),98);
__d("ZenonDialogProvider.react",["ZenonDialogContext","react","useZenonDialogSetters"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useState;function a(a){a=a.children;var b=i(null),d=b[0];b=b[1];var e=i([]),f=e[0];e=e[1];b=c("useZenonDialogSetters")(b,e);return h.jsxs(c("ZenonDialogContext").Provider,{value:b,children:[a,d,f.map(function(a){a=a.node;return a})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("RTWebCometCallInviteController.react",["RTWebCallBlockSettingHooks","RTWebCallInviteDesktopNotification.react","RTWebCometCallInviteDialogs.react","RTWebPreCallHooks","ZenonCallInviteRingtone.react","ZenonCallInviteTitleBlinking.react","ZenonDialogProvider.react","react","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=c("requireDeferred")("FBRTCCallSummaryUploader").__setRef("RTWebCometCallInviteController.react");b.onReady(function(a){a.init()});function a(){d("RTWebCallBlockSettingHooks").useCallBlockSetting();d("RTWebPreCallHooks").useNoAnswerTimeout();var a=d("RTWebPreCallHooks").useCallInvite();return h.jsxs(c("ZenonDialogProvider.react"),{children:[h.jsx(c("RTWebCometCallInviteDialogs.react"),{invite:a}),h.jsx(c("RTWebCallInviteDesktopNotification.react"),{invite:a}),h.jsx(c("ZenonCallInviteRingtone.react"),{invite:a}),h.jsx(c("ZenonCallInviteTitleBlinking.react"),{invite:a})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("RTWebCallWindowOpener",["cr:1099565"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:1099565")}),98);
__d("RTWebCometIncomingCallContent.react",["fbt","CometProgressIndicator.react","RTWebCometCallMessageLayout.react","ZenonUsersHooks","cr:1568669","cr:1568670","emptyFunction","gkx","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=d("react").useEffect,k=b("cr:1568669")?b("cr:1568669").addPoint:c("emptyFunction"),l=b("cr:1568670")?b("cr:1568670").useCallInvite:c("emptyFunction"),m=c("gkx")("1536863")?e:c("emptyFunction");function a(a){var b=a.inviterID,e=a.isVideoCall;a=a.participantIDs;b=d("ZenonUsersHooks").useZenonUser(b);var f=d("ZenonUsersHooks").useZenonUsers(a).valueSeq().toArray();m(f,a,64225282);a=a.length>1;var g=a?e?h._("{caller name} zaprasza Ci\u0119 do grupowej rozmowy wideo.",[h._param("caller name",b==null?void 0:b.name)]):h._("{caller name} zaprasza Ci\u0119 do rozmowy grupowej.",[h._param("caller name",b==null?void 0:b.name)]):h._("{caller name} dzwoni do Ciebie.",[h._param("caller name",b==null?void 0:b.name)]);a=a?e?h._("Tw\u00f3j film zostanie udost\u0119pniony, gdy odbierzesz po\u0142\u0105czenie"):h._("Rozmowa rozpocznie si\u0119, kiedy odbierzesz."):h._("Rozmowa rozpocznie si\u0119, kiedy odbierzesz.");return b===null?i.jsx(c("CometProgressIndicator.react"),{}):i.jsx(c("RTWebCometCallMessageLayout.react"),{caller:b,mainMessage:g,participants:f,subMessage:a})}a.displayName=a.name+" [from "+f.id+"]";function e(a,b,c){var d=n();j(function(){a.length===0&&k(c,"fetching_participants",{instanceKey:d}),a.length===b.length&&k(c,"fetched_participants",{instanceKey:d})},[d,b.length,a,c])}function n(){var a=l();return+(a==null?void 0:a.ringID)}g["default"]=a}),98);
__d("ZenonCallInviteModelTypes",[],(function(a,b,c,d,e,f){"use strict";a={missed:"missed",ringing:"ringing",unsupported_browser:"unsupported_browser"};f.CallInviteModelType=a}),66);
__d("ZenonCallInviteModel",["BaseEventEmitter","FBLogger","ZenonCallInviteModelTypes","ZenonCallsModelTypes","ZenonIncomingRingSDKTypes","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var e;e=a.call(this)||this;e.$ZenonCallInviteModel3=function(a){c("FBLogger")("rtc_www").info("Received cancel for: ",a.ringID);if(e.__currentRequest&&e.__currentRequest.model&&e.__currentRequest.model.ringID===a.ringID)switch(a.reason){case d("ZenonIncomingRingSDKTypes").ZenonCancelReason.Hangup:a=((a=e.__currentRequest)==null?void 0:(a=a.model)==null?void 0:a.type)!==d("ZenonCallInviteModelTypes").CallInviteModelType.unsupported_browser;e.__currentRequest.model=babelHelpers["extends"]({},e.__currentRequest.model,{type:"missed"});a&&e.emit("callInvite",e.__currentRequest.model);break;case d("ZenonIncomingRingSDKTypes").ZenonCancelReason.OtherDismiss:e.dismiss();break}};e.$ZenonCallInviteModel2=function(a){var b;c("FBLogger")("rtc_www").info("Receiving ring: ",a.ringID);if(((b=e.__currentRequest)==null?void 0:(b=b.model)==null?void 0:b.type)==="ringing"){if(((b=e.__currentRequest)==null?void 0:(b=b.model)==null?void 0:b.ringID)!==a.ringID&&c("gkx")("1434282")){a.onDecline("InAnotherCall");c("FBLogger")("rtc_www").info("Sending InAnotherCall to ring: ",a.ringID,"Current ring: ",(b=e.__currentRequest)==null?void 0:(b=b.model)==null?void 0:b.ringID)}}else e.__currentRequest={model:{context:a.context,controllerParams:a.controllerParams,inviterID:a.inviterID,participants:a.otherParticipants,requestingVideo:a.requestingVideo,ringID:a.ringID,type:a.isClientPermissableRing?"ringing":"unsupported_browser"},ringPayload:a},e.emit("callInvite",e.__currentRequest.model),a.isClientPermissableRing||a.onDecline("VersionUnsupported")};e.$ZenonCallInviteModel1=function(a){c("FBLogger")("rtc_www").info("Blocking ring: ",a.ringID),a.onDecline("IgnoreCall",d("ZenonCallsModelTypes").ZenonEndCallSubreason.CallsBlocked)};e.__eventSource=b;e.__currentRequest=null;return e}var e=b.prototype;e.getCurrentInvite=function(){var a;return(a=(a=this.__currentRequest)==null?void 0:a.model)!=null?a:null};e.startListening=function(a){a=a.callsBlocked;this.__currentRequest&&this.dismiss();this.stopListening();a?this.__eventSource.addListener("incomingRing",this.$ZenonCallInviteModel1):(this.__eventSource.addListener("incomingRing",this.$ZenonCallInviteModel2),this.__eventSource.addListener("ringCancel",this.$ZenonCallInviteModel3))};e.stopListening=function(){this.__eventSource.removeAllListeners("incomingRing"),this.__eventSource.removeAllListeners("ringCancel"),this.__currentRequest=null};e.dismiss=function(){var a;c("FBLogger")("rtc_www").info("Dismissing ring: ",(a=this.__currentRequest)==null?void 0:(a=a.model)==null?void 0:a.ringID);this.__currentRequest=null;this.emit("callInvite",null)};e.accept=function(a,b){var d=this.__currentRequest;if(d){var e;c("FBLogger")("rtc_www").info("Accepting ring: ",(e=d.model)==null?void 0:e.ringID);((e=d.model)==null?void 0:e.type)==="ringing"&&d.ringPayload.onAccept(a,b);this.dismiss()}};e.decline=function(a,b){a===void 0&&(a="IgnoreCall");var d=this.__currentRequest;if(d){var e;c("FBLogger")("rtc_www").info("Declining ring: ",(e=d.model)==null?void 0:e.ringID);d.ringPayload.onDecline(a,b);this.dismiss();return}};return b}(c("BaseEventEmitter"));g["default"]=a}),98);
__d("delegateZenonCallInviteModel",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a.getCurrentInvite=b.getCurrentInvite.bind(b),a.startListening=b.startListening.bind(b),a.stopListening=b.stopListening.bind(b),a.dismiss=b.dismiss.bind(b),a.accept=b.accept.bind(b),a.decline=b.decline.bind(b),b.addListener("callInvite",function(b){a.emit("callInvite",b)})}f["default"]=a}),66);
__d("ZenonCallWindowController",["FBLogger","Promise","ZenonCallWindowErrors"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){var c=b.callWindowInitializerResource,d=b.callWindowOpener;b=b.uriBuilderResource;this.$2=null;this.$3=!1;this.$5=null;this.$1=a;this.$7=b;this.$4=c;this.$6=d}var e=a.prototype;e.initCall=function(a){var e=this;if(this.$3)throw new(d("ZenonCallWindowErrors").OpeningAnotherCallError)();try{if(this.$2&&!this.$2.closed&&a.joinContext.type==="thread"&&this.$2.inCallWith===a.joinContext.thread.id){this.$2.focus();return[this.$2,b("Promise").resolve({alohaEscalatedMW:!1})]}}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to access inCallWith on call window")}var f=this.$6.openWindow(a);try{this.$2&&(this.$2.closed||this.$2.close(),this.$2=null)}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to access close on call window")}this.$2=f;this.$3=!0;return[f,b("Promise").all([this.$7.load(),this.$4.load()]).then(function(b){var c=b[0];b=b[1];e.$5===null&&(e.$5=new b(e.$1,new c(e.$1)));return e.$5.initCall(e.$2,a)})["finally"](function(){e.$3=!1})]};return a}();g["default"]=a}),98);
__d("CometWatchAndScrollControlNUXContext",["react"],(function(a,b,c,d,e,f,g){"use strict";a=d("react");b={isVideoPlayerWatchAndScrollControlNUXVisible:!1,setIsVideoPlayerWatchAndScrollControlNUXVisible:null};c=a.createContext(b);g["default"]=c}),98);
__d("ZenonCallLogger",["ZenonInfraActionsLogger","gkx","uuid"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(["setMediaStats"]);a=function(){function a(a,b){var d,e=this;this.$1=[];this.$2={localCallID:c("uuid")(),peerID:a.peerID,sharedCallID:(d=a.serverInfoData)!=null?d:a.callID};b.forEach(function(b){return e.$1.push(new b(a,function(a){Object.assign(e.$2,a)}))})}var b=a.prototype;b.log=function(a){!h.has(a.name)&&c("gkx")("1439080")&&c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"[ZP] ZenonCallLogger event: "+a.name}),this.$1.forEach(function(b){b.processEvent(a)})};b.getLogIdentifiers=function(){return this.$2};return a}();g["default"]=a}),98);
__d("ZenonDeviceInfoHelper",["regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";var g=-1,h=!1,i={getBatteryStats:function(){var a,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(i.internalGetWindow().navigator.getBattery);case 2:a=d.sent;if(!(typeof a!=="function")){d.next=5;break}return d.abrupt("return",{level:g,placeholder:!0,wasCharged:!1});case 5:d.next=7;return b("regeneratorRuntime").awrap(a.call(navigator));case 7:c=d.sent;c.charging?h=!0:c.onchargingchange=function(a){a.target.charging&&(h=!0),a.target.onchargingchange=null};return d.abrupt("return",{level:c.level*100,placeholder:!1,wasCharged:h});case 10:case"end":return d.stop()}},null,this)},internalGetWindow:function(){return window}};a=i;f["default"]=a}),66);
__d("ZenonDeviceInfoUtils",["UserAgentData"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("UserAgentData").browserName,b=c("UserAgentData").platformName;window.navigator.userAgent.toLowerCase().includes("mobile")&&(b+=" Mobile",a==="Chrome"&&(a="Mobile "+a));window.external&&window.external.pinPage&&(a==="Chrome"&&(a+=" Edge"));return{browser:a,browser_version:c("UserAgentData").browserFullVersion,device:c("UserAgentData").deviceName,os:b,os_version:c("UserAgentData").platformFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth,user_agent:window.navigator.userAgent}}g.getDeviceSoftwareInfo=a}),98);
__d("ZenonVCSTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({DIRECT_VIDEO:"direct_video",ESCALATED:"escalated",ESCALATION_DECLINED:"escalation_declined",MWS:"mws",VOIP:"voip"});c=b("$InternalEnum")({LL_BASIC:1,LL_DEBUG:2,LL_INFO:4,LL_NIL:0,LL_VERBOSE:5,LL_WARNING:3});f.ZenonCallType=a;f.ZenonUploadLogLevel=c}),66);
__d("ZenonLocalUploadLogLevel",["CurrentUser","ZenonVCSTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return Math.max(h(),a)}function h(){return c("CurrentUser").isEmployee()||c("CurrentUser").isTestUser()?d("ZenonVCSTypes").ZenonUploadLogLevel.LL_DEBUG:d("ZenonVCSTypes").ZenonUploadLogLevel.LL_NIL}g.getUploadLogLevel=a;g.getLocalUploadLogLevel=h}),98);
__d("ZenonSignalingProtocolUtils",["ZenonSignalingProtocol"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set([c("ZenonSignalingProtocol").MW,c("ZenonSignalingProtocol").MWPP]);a={isMwSupportedProtocol:function(a){return h.has(a)}};b=a;g["default"]=b}),98);
__d("ZenonCallSummary",["ChannelClientID","SiteData","WebPerformanceDeviceInfo","ZenonBrowsers","ZenonDeviceInfoHelper","ZenonDeviceInfoUtils","ZenonDismissReason","ZenonIceStatsParser","ZenonLocalUploadLogLevel","ZenonLoggingEventTypes","ZenonPeerID","ZenonSignalingProtocol","ZenonSignalingProtocolUtils","ZenonVCSTypes","gkx","performanceNow","regeneratorRuntime","uuid"],(function(a,b,c,d,e,f,g){"use strict";var h={PRESSED_ANSWER:"p_a"};function i(a){var b=c("gkx")("1984542"),e=c("gkx")("1845186"),f=d("ZenonBrowsers").isFBWebviewWithChromeMinVersion(67)&&c("gkx")("1888615");b=b||e||f;if(c("ZenonSignalingProtocolUtils").isMwSupportedProtocol(a)&&b)return"ZenonPlatform";e=c("gkx")("1341692");f=c("gkx")("1680228");return!e&&!f?"ZenonScotch":"Old Codebase"}var j=19,k=24,l={CALL_CONNECTED:"connected",CALL_ENDED:"ended",CALL_STARTED:"started",NEGOTIATION_COMPLETED:"negotiation_completed",NETWORK_READY:"network_ready",PROC_JOIN_RESPONSE:"p_jresp",RECV_ANSWER:"r_a",RECV_ANSWER_ACK:"r_aack",RECV_JOIN_RESPONSE:"r_jresp",RECV_OFFER:"r_o",RECV_OFFER_ACK:"r_oack",RECV_OK:"r_ok",RECV_PRANSWER:"r_pr",RECV_RETRIED_ANSWER:"r_a2",RECV_RETRIED_ANSWER_ACK:"r_aack2",RECV_RETRIED_OFFER:"r_o2",RECV_RETRIED_OFFER_ACK:"r_oack2",RECV_RING_REQUEST:"r_rreq",SENT_ANSWER:"s_a",SENT_ANSWER_ACK:"s_aack",SENT_JOIN_REQUEST:"s_jreq",SENT_OFFER:"s_o",SENT_OFFER_ACK:"s_oack",SENT_OK:"s_ok",SENT_PRANSWER:"s_pr",SENT_RETRIED_ANSWER:"s_a2",SENT_RETRIED_ANSWER_ACK:"s_aack2",SENT_RETRIED_OFFER:"s_o2",SENT_RETRIED_OFFER_ACK:"s_oack2",SENT_RING_RESPONSE:"s_rresp"},m={FIRST_MEDIA:"r_media",FIRST_VIDEO:"r_video"},n={BATTERY_END:"battery_end",BATTERY_START:"battery_start",CONNECTION_EFFECTIVE_TYPE:"conn_effective_type",DESKTOP_DEVICE_CLASS:"desktop_device_class",DEVICE_INFO:"device_info",INITIATED_BY_APP_ID:"initiated_by_app_id",INITIATED_BY_PAGE_ID:"initiated_by_page_id",MAX_CONCURRENT_CONNECTED_PARTICIPANTS:"max_concurrent_connected_participants",PEER_IS_MOBILE:"peer_is_mobile",RATING:"rating5",RATING_SHOWN:"rating_shown",ROOM_SURFACE:"room_surface",SURVEY_CHOICE:"survey_choice",SURVEY_DETAILS:"survey_details",SURVEY_SHOWN:"survey_shown",YEAR_CLASS:"year_class"};a=function(){function a(a){var b=a.callID,e=a.callTrigger,f=a.isCaller,g=a.isVideo,h=a.localCallID,j=a.peerID,l=a.protocol;a=a.uploadLogLevel;this.$23=0;this.$24=0;this.$29={};this.$30={};this.$31={};this.$32={};this.$33=!1;this.$35=0;this.$36=!1;this.$37={};this.$38={};this.$39={};this.$40={};this.$46={CoreAudioMetrics:{isstall:0},CoreVideoMetrics:{screen:{capture_stall:{is_stall:0},encode_stall:{is_stall:0},sent_stall:{is_stall:0}},video:{capture_stall:{is_stall:0},encode_stall:{is_stall:0},sent_stall:{is_stall:0}}},DebugAudioMetrics:{NetworkReceive:{}},extraInfo:{},receiver:{},sender:{},video:{}};this.$48={};this.$49={};this.$50="sfu";this.$52={};this.peerID=j;this.callID=b;this.localCallID=(j=h)!=null?j:c("uuid")();this.$1=d("ChannelClientID").getID();this.$3=f;this.$2=k;this.$6=i(l);this.$4=(b=a)!=null?b:d("ZenonLocalUploadLogLevel").getLocalUploadLogLevel();this.$5=e;this.$26=new Date().valueOf();this.$7=l===c("ZenonSignalingProtocol").P2P?"p2p":"mws";this.$19=null;this.$18=null;this.$34=this.peerID===d("ZenonPeerID").ZenonMWPeerID;this.$14=c("SiteData").push_phase;this.$7==="p2p"?this.setCallType(g?d("ZenonVCSTypes").ZenonCallType.DIRECT_VIDEO:d("ZenonVCSTypes").ZenonCallType.VOIP):this.setCallType(d("ZenonVCSTypes").ZenonCallType.MWS);this.$28=c("performanceNow")();this.$27=0;this.$25=this.$28;this.$51=0;this.$52[n.DEVICE_INFO]=d("ZenonDeviceInfoUtils").getDeviceSoftwareInfo();this.$54();this.updateBatteryStart();this.$55();this.$56()}a.$57=function(a){try{return JSON.parse(a)}catch(a){return null}};a.fromJsonString=function(b){var e;b=this.$57(b);if(b==null)return null;if(b.version<j)return null;if(!Object.prototype.hasOwnProperty.call(b,"peerID")||!Object.prototype.hasOwnProperty.call(b,"callID")||!Object.prototype.hasOwnProperty.call(b,"isCaller")||!Object.prototype.hasOwnProperty.call(b,"startTime")||!Object.prototype.hasOwnProperty.call(b,"trigger")||!Object.prototype.hasOwnProperty.call(b,"signalingTime")||!Object.prototype.hasOwnProperty.call(b,"lastUpdatedTime")||!Object.prototype.hasOwnProperty.call(b,"lastSerializedTime"))return null;var f=b.activeConn==="p2p"?c("ZenonSignalingProtocol").P2P:c("ZenonSignalingProtocol").MW;f=new a({callID:b.callID,isCaller:b.isCaller,isVideo:b.callType===d("ZenonVCSTypes").ZenonCallType.DIRECT_VIDEO,localCallID:b.localCallID,peerID:b.peerID,protocol:f});f.$1=b.deviceID;f.$2=b.version;f.$4=b.uploadLogLevel;f.$26=b.startTime;f.$5=b.trigger;f.$50=b.mediaMode;f.$34=b.isUsingMultiway;f.$33=b.hasOfferInRingRequest;f.$35=(e=b.renegotiationCmuRequestSent)!=null?e:0;f.$6=b.clientVersion;f.$29=b.signalingTime;f.$15=b.endCallReason;f.$16=b.endCallSubreason;f.$17=b.isRemoteEnded;f.$23=b.lastUpdatedTime;f.$24=b.lastSerializedTime;f.$9=b.joinWithSID;f.$19=(e=b.endIsConnected)!=null?e:null;f.$18=(e=b.pcIsConnected)!=null?e:null;f.$36=b.hasAnswerInJoinResponse;b.conferenceName!=null&&(f.$8=b.conferenceName);b.escP2PCallID!=null&&(f.$10=b.escP2PCallID);b.activeConn!=null&&(f.$7=b.activeConn);b.serverInfoData!=null&&(f.$12=b.serverInfoData);b.localVideoDuration!=null&&(f.$41=b.localVideoDuration);b.remoteVideoDuration!=null&&(f.$42=b.remoteVideoDuration);b.unsetOnRetrieve!=null&&(f.$22=b.unsetOnRetrieve);b.openCount!=null&&(f.$51=b.openCount);b.extraInfo&&(f.$52=b.extraInfo);b.gen0IceSentCount&&(f.$37=b.gen0IceSentCount);b.gen0IceReceivedCount&&(f.$38=b.gen0IceReceivedCount);b.iceConnections&&(f.$48=b.iceConnections);b.iceSentCount&&(f.$39=b.iceSentCount);b.iceReceivedCount&&(f.$40=b.iceReceivedCount);b.pcConnectionStates&&(f.$49=b.pcConnectionStates);b.accumulatedCallTime!=null&&(f.$27=b.accumulatedCallTime);b.escStateTimes&&(f.$30=b.escStateTimes);b.applicationEventTime&&(f.$31=b.applicationEventTime);b.videoEscTimes&&(f.$32=b.videoEscTimes);b.mediaStats&&(f.$46=b.mediaStats);b.connectionType!==void 0&&(f.$20=b.connectionType);b.deviceCharged!=null&&(f.$53=b.deviceCharged);b.videoReceivedCodec!==null&&(f.$43=b.videoReceivedCodec);b.videoSentCodec!==null&&(f.$44=b.videoSentCodec);b.audioSentCodec!==null&&(f.$45=b.audioSentCodec);b.relayIP!==null&&b.relayIP!==void 0&&(f.$21=b.relayIP);b.startReach!=null&&(f.$47=b.startReach);b.sdpFormat!=null&&(f.$13=b.sdpFormat);return f};var e=a.prototype;e.toJsonString=function(){var a;this.$24=new Date().valueOf();a={accumulatedCallTime:this.$58(),activeConn:(a=this.$7)!=null?a:"p2p",applicationEventTime:this.$31,audioSentCodec:this.$45,callID:this.callID,callType:this.$11,clientVersion:this.$6,conferenceName:this.$8,connectionType:this.$20,deviceCharged:this.$53,deviceID:this.$1,endCallReason:this.$15,endCallSubreason:this.$16,endIsConnected:this.$19,escP2PCallID:this.$10,escStateTimes:this.$30,extraInfo:this.$52,gen0IceReceivedCount:this.$38,gen0IceSentCount:this.$37,hasAnswerInJoinResponse:this.$36,hasOfferInRingRequest:this.$33,iceConnections:this.$48,iceReceivedCount:this.$40,iceSentCount:this.$39,isCaller:this.$3,isRemoteEnded:this.$17,isUsingMultiway:this.$34,joinWithSID:this.$9,lastSerializedTime:this.$24,lastUpdatedTime:this.$23,localCallID:this.localCallID,localVideoDuration:this.$41,mediaMode:this.$50,mediaStats:this.$46,pcConnectionStates:this.$49,pcIsConnected:this.$18,peerID:this.peerID,relayIP:this.$21,remoteVideoDuration:this.$42,renegotiationCmuRequestSent:this.$35,sdpFormat:this.$13,serverInfoData:this.$12,signalingTime:this.$29,startReach:this.$47,startTime:this.$26,trigger:this.$5,unsetOnRetrieve:this.$22,uploadLogLevel:this.$4,version:this.$2,videoEscTimes:this.$32,videoReceivedCodec:this.$43,videoSentCodec:this.$44};return JSON.stringify(a)};e.unsetEndCallFields=function(){this.$15=null,this.$16=null,this.$17=null,this.$19=null,delete this.$29[l.CALL_ENDED],this.$28=0,this.$22=null};e.isNull=function(){return this.peerID==="0"&&this.callID==="0"&&!this.$3&&this.$5==="NULL_SUMMARY"};e.getExtraInfo=function(){return this.$52};e.getLastUpdatedTime=function(){return this.$23};e.getMediaStats_DEBUG=function(){return this.$46};e.getDeviceID=function(){return this.$1};e.setDeviceID=function(a){this.$1=a};e.getSdpFormat=function(){return this.$13};e.setSdpFormat=function(a){this.$13=a};e.getLoggingArgs=function(){var a;return{call_id:this.callID,conf_name:(a=this.$8)!=null?a:"",peer_id:d("ZenonPeerID").convertPeerIDForLogging(this.peerID),serv_info:(a=this.$12)!=null?a:"",web_device_id:this.$1}};e.getDeviceCharged=function(){return this.$53};e.setDeviceCharged=function(a){this.$53!==!0&&(this.$53=a)};e.updateLastSavedTime=function(){this.$25=c("performanceNow")()};e.onCallAccepted=function(a){this.$31[h.PRESSED_ANSWER]=this.$58(),this.$5=a,this.$56()};e.onCallJoinRequest=function(a){this.$33=a,this.$34=this.peerID===d("ZenonPeerID").ZenonMWPeerID,this.$56()};e.onCallConnected=function(a){this.$59(l.CALL_CONNECTED),this.$50=a,this.$56()};e.onNegotiationComplete=function(){this.$59(l.NEGOTIATION_COMPLETED),this.$56()};e.onCallEscalated=function(a){this.$50==="p2p"&&a==="sfu"?this.$50="p2p_sfu_escalated":this.$50=a,this.$35=this.$58(),this.$56()};e.onCallEnded=function(a,b,c,d){this.$22=c,this.$15=a,this.$16=d,this.$17=b,this.$59(l.CALL_ENDED),this.$19==null&&(this.$19=this.$18),this.$56()};e.setPCIsConnected=function(a){this.$18!==a&&(this.$18=a,this.$49[this.$58()]=a)};e.onInviteResponded=function(){var a=this.$7==="p2p"?l.SENT_OFFER_ACK:l.SENT_RING_RESPONSE;this.$59(a);this.$56()};e.onInviteReceived=function(){var a=this.$7==="p2p"?l.RECV_OFFER:l.RECV_RING_REQUEST;this.$59(a);this.$56()};e.onInviteSent=function(){this.$59(l.SENT_JOIN_REQUEST),this.$56()};e.onInviteResponseReceived=function(){this.$59(l.RECV_JOIN_RESPONSE),this.$56()};e.onInviteResponseProcessed=function(){this.$59(l.PROC_JOIN_RESPONSE),this.$56()};e.onMediaConnected=function(){this.$59(l.NETWORK_READY),this.$56()};e.setIsPeerMobile=function(a){this.$52[n.PEER_IS_MOBILE]=a?"1":"0",this.$56()};e.setCallType=function(a){this.$11=a,this.$56()};e.setConferenceName=function(a){this.$8=a,this.$56()};e.setConnectionType=function(a){this.$20=a,this.$56()};e.setInitByPageID=function(a){this.$52[n.INITIATED_BY_PAGE_ID]=a,this.$56()};e.setInitByAppID=function(a){a!=null&&(this.$52[n.INITIATED_BY_APP_ID]=a,this.$56())};e.setJoinWithSID=function(a){this.$9=a,this.$56()};e.setMediaStats=function(a){var b=this;this.$46=a;a=a.extraInfo;var c=a.localIceCandidate,d=a.mediaPacketTimes;a=a.remoteIceCandidate;if(c){(this.$47==null||this.$47==="")&&(this.$47=c.networkType);if(a){var e=c.candidateType;c=c.protocol;var f=a.candidateType;a=a.protocol;if(e!=null&&c!=null&&f!=null&&a!=null){e="l:"+e+"-"+c+";r:"+f+"-"+a;this.$48[e]==null&&(this.$48[e]=this.$58())}}}if(d!=null){c=new Map([[m.FIRST_MEDIA,d.audio],[m.FIRST_VIDEO,d.video]]);c.forEach(function(a,c){if(a!=null){a=a-b.$28;b.$29[c]==null&&(b.$29[c]=Math.floor(b.$27+a))}})}this.updateBatteryEnd();this.$56()};e.setServerInfoData=function(a){this.$12=a,this.$56()};e.setRating=function(a){this.$52[n.RATING]=a,this.$56()};e.setFeedback=function(a){this.$52[n.SURVEY_DETAILS]=a,this.$56()};e.setSurveyChoice=function(a){this.$52[n.SURVEY_CHOICE]=a,this.$56()};e.setMaxConnectedParticipants=function(a){this.$52[n.MAX_CONCURRENT_CONNECTED_PARTICIPANTS]=a,this.$56()};e.setHasAnswerInJoinResponse=function(a){this.$36=a,this.$56()};e.setLinkSurface=function(a){this.$52[n.ROOM_SURFACE]=a,this.$56()};e.updateIceInfo=function(a,b){var c=b===d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send?this.$37:this.$38,e=b===d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send?this.$39:this.$40;b=d("ZenonIceStatsParser").extractIceInfo(a);b.forEach(function(a){var b=a.gen;a=a.type;b===0&&(c[a]==null?c[a]=1:c[a]++);e[a]==null?e[a]=1:e[a]++})};e.$59=function(a){if(this.$29[a]!=null)return;this.$29[a]=this.$58()};e.$58=function(){var a=c("performanceNow")()-this.$28;return Math.floor(this.$27+a)};e.$56=function(){this.$23=new Date().valueOf()};e.$55=function(){var a=d("WebPerformanceDeviceInfo").getMobileYearClass();a!=null&&a>0?this.$52[n.YEAR_CLASS]=a:this.$52[n.DESKTOP_DEVICE_CLASS]=d("WebPerformanceDeviceInfo").getDeviceLevel()};e.updateBatteryStart=function(){var a,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(c("ZenonDeviceInfoHelper").getBatteryStats());case 2:a=f.sent,d=a.level,e=a.placeholder,e!==!0&&(this.$52[n.BATTERY_START]=d);case 6:case"end":return f.stop()}},null,this)};e.updateBatteryEnd=function(){var a,d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(c("ZenonDeviceInfoHelper").getBatteryStats());case 2:a=g.sent,d=a.level,e=a.placeholder,f=a.wasCharged,e!==!0&&(this.$52[n.BATTERY_END]=d,this.setDeviceCharged(f));case 7:case"end":return g.stop()}},null,this)};e.toString=function(){var a={core_metrics:this.$60(),time_series:null};return JSON.stringify(a)};e.$60=function(){return{CoreAudioMetrics:this.$46.CoreAudioMetrics,CoreVideoMetrics:this.$46.CoreVideoMetrics,DebugAudioMetrics:this.$46.DebugAudioMetrics,active_conn:this.$7,answer_in_join_resp:this.$36,app_event_times:this.$31,call_type:this.$11,caller:this.$3,client_version:this.$6,conf_name:this.$8,conn:this.$61(),device_charged:this.$53,end:this.$62(),esc_p2p_call_id:this.$10,esc_state_times:this.$30,is_using_multiway:this.$34,join_with_sid:this.$9,log_level:this.$63(d("ZenonVCSTypes").ZenonUploadLogLevel.cast(this.$4)),offer_in_ring_req:this.$33,open_count:this.$51,peer_id:d("ZenonPeerID").convertPeerIDForLogging(this.peerID),perf:this.$64(),push_phase:this.$14,receiver:this.$65(),sdp_reneg_times:[{crs:this.$35}],sender:this.$66(),serv_info:this.$12,signaling:this.$67(),ver:this.$2,vid_esc_times:this.$32,video:this.$46.video}};e.$63=function(a){if(a==null)return"";switch(a){case d("ZenonVCSTypes").ZenonUploadLogLevel.LL_BASIC:return"basic";case d("ZenonVCSTypes").ZenonUploadLogLevel.LL_DEBUG:return"debug";case d("ZenonVCSTypes").ZenonUploadLogLevel.LL_WARNING:return"warning";case d("ZenonVCSTypes").ZenonUploadLogLevel.LL_INFO:return"info";case d("ZenonVCSTypes").ZenonUploadLogLevel.LL_VERBOSE:return"verbose";default:return""}};e.$61=function(){var a={},b=this.$46.sender,c=b.avgrtt,d=b.maxrtt;b=b.minrtt;c!=null&&(a.avgrtt=c,a.maxrtt=d,a.minrtt=b);this.$21!=null&&(a.relay_ip=this.$21);this.$47!=null&&this.$47!==""&&(a.start_reach=this.$47);var e={};Object.entries(this.$48).forEach(function(a){var b=a[0];a=a[1];typeof a==="number"&&(e[a]=b)});a.types=e;a.ctd=this.$49;return a};e.$67=function(){var a={start_time:this.$26,time_from_start:this.$29};this.$5!=null&&(a.trigger=this.$5);var b=this.$68();b>0&&(a.duration=b);return a};e.$66=function(){return babelHelpers["extends"]({},this.$46.sender,{ice:this.$39,ice_g0:this.$37})};e.$65=function(){return babelHelpers["extends"]({},this.$46.receiver,{ice:this.$40,ice_g0:this.$38})};e.$68=function(a){var b=this.$29[l.CALL_CONNECTED]||this.$29[l.NETWORK_READY];if(!b)return 0;a=this.$29[l.CALL_ENDED]||!(a==null?void 0:a.assumeOngoing)&&this.$27||this.$58();return Math.max(0,a-b)};e.$62=function(){var a,b={};this.$15!=null&&(b.end_call_reason_string=d("ZenonDismissReason").dismissToEndCallReason(this.$15),this.$16!==null&&(b.end_call_subreason_string=this.$16),b.remote_ended=this.$17,b.end_ctd=this.$19);this.$20!=null&&(b.conn_type=this.$20);a=(a=this.$46.extraInfo)!=null?a:{};a=a.localIceCandidate;a&&a.networkType!==""&&(b.reach=a.networkType);return b};e.$64=function(){var a,b,c=this.$68();if(c<=0)return;a=(a=(a=this.$46.video.receiver)==null?void 0:a.tdt)!=null?a:0;b=(b=(b=this.$46.video.sender)==null?void 0:b.tet)!=null?b:0;a=a+b;b=Math.round(100*(a/c));return{cpu:{proc:{avg:b}}}};e.$54=function(){var a;((a=window.navigator.connection)==null?void 0:a.effectiveType)!=null&&(this.$52[n.CONNECTION_EFFECTIVE_TYPE]=window.navigator.connection.effectiveType)};return a}();g["default"]=a}),98);
__d("ZenonGenericCallSummaryStore",["CacheStorage","WebStorage","ZenonInfraActionsLogger","ZenonUserActionLogger","areEqual","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=2e3,i=3;a=function(){function a(a,b,d){this.$1=a,this.$2=new(c("CacheStorage"))(b,d)}var b=a.prototype;b.getCallSummaries=function(){return this.$2.get(this.$1)||{}};b.removeCallSummaries=function(a){this.mutateCallSummaries(function(b){a.forEach(function(a){var c=a.callID;a=a.peerID;b[a]&&b[a][c]&&(delete b[a][c],Object.entries(b[a]).length===0&&delete b[a])});return b})};b.mutateCallSummaries=function(a,b,d,e){var f=this;b===void 0&&(b=i);d===void 0&&(d=!1);e===void 0&&(e=null);var g=this.getCallSummaries(),j=this.getCallSummaries();g=a(g);var k=this.getCallSummaries();c("areEqual")(j,k)?(this.$2.set(this.$1,g),this.logStorageError(this.$2.getLastSetException(),e)):b>0&&(d?c("setTimeout")(function(){f.mutateCallSummaries(a,b-1,!0)},h):this.mutateCallSummaries(a,b-1,!0))};b.logStorageError=function(a,b){a!=null&&(d("ZenonUserActionLogger").logError({call_id:b==null?void 0:b.callID,error_domain:"ZenonGenericCallSummaryStore_storeCallSummary",error_type:a.name,peer_id:b==null?void 0:b.peerID}),c("WebStorage").isLocalStorageQuotaExceeded()&&c("ZenonInfraActionsLogger").logCounter("local_storage_quota_exceeded"))};return a}();g["default"]=a}),98);
__d("ZenonCallSummaryStore",["FBLogger","ZenonCallSummary","ZenonGenericCallSummaryStore"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i="RTC_CALL_SUMMARY_",j="summary",k=3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,j,h,i)||this}var d=b.prototype;d.retrieveCallSummary=function(a,b){var d=this.getCallSummaries();d=d[a]?d[a][b]:null;if(d)return c("ZenonCallSummary").fromJsonString(d.__d);else return null};d.storeCallSummary=function(a){if(a.isNull()){c("FBLogger")("rtweb").mustfix("Storing invalid ZenonCallSummary!");return}var b=a.peerID,d=a.callID;this.mutateCallSummaries(function(c){c[b]||(c[b]={});c[b][d]={__d:a.toJsonString(),__t:Date.now(),__z:!0};return c},k,!1,{callID:d,peerID:b});a.updateLastSavedTime()};return b}(c("ZenonGenericCallSummaryStore"));b=new a();g.ZenonCallSummaryStoreInstance=b}),98);
__d("MarauderLogger",["Banzai","CacheStorage","MarauderConfig"],(function(a,b,c,d,e,f){var g="client_event",h="navigation",i=18e4,j="marauder",k="marauder_last_event_time",l="marauder_last_session_id",m={},n=[],o=!1,p=null,q=null,r=null,s=0,t,u,v=!1,w=null;function a(){F().set(k,x())}b("Banzai").subscribe(b("Banzai").SHUTDOWN,a);function x(){t=t||F().get(k)||0;return t}function y(){v||(u=F().get(l),v=!0);var a=Date.now();(!u||a-i>x())&&(u=a.toString(16)+"-"+(~~(Math.random()*16777215)).toString(16),F().set(l,u));return u}function z(){return{user_agent:window.navigator.userAgent,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth,density:window.screen.devicePixelRatio||null,platform:window.navigator.platform||null,locale:window.navigator.language||null}}function A(){return{locale:navigator.language}}function B(a,b,c,d,e,f,g){var h=g!=null&&g!=0?g:Date.now();t=g!=null&&g!=0?Date.now():h;g=b!=null&&b!=""?b:p;return{name:a,time:h/1e3,module:g,obj_type:d,obj_id:e,uuid:f,extra:c}}function C(a,b,c){return B("content",null,{flags:b},null,null,a,c)}function D(a){var b=window.__mrdr;if(b)for(var c in b){var d=b[c];if(d[3]!==0){delete b[c];if(c==="1")if(r!==null)c=r;else continue;a.push(C(c,1,d[1]));a.push(C(c,2,d[2]));a.push(C(c,3,d[3]))}}}function E(a,c){D(a);if(a.length===0)return;o&&a.push(B("counters",null,m));var d=b("Banzai").BASIC;c==="vital"&&(d=b("Banzai").VITAL);var e=b("MarauderConfig").gk_enabled;s===0&&e&&(a.push(B("device_status",null,A())),d={delay:5e3});c==="signal"&&(d={signal:!0});e&&Math.random()<.01&&a.push(B("device_info",null,z()));if(r!==null)for(var c=0;c<a.length;c++){e=a[c];(e.uuid===null||e.uuid===void 0)&&(e.uuid=r)}e={app_ver:b("MarauderConfig").app_version,data:a,device_id:void 0,log_type:g,seq:s++,session_id:y()};c=F().get("device_id");c&&(e.device_id=c);m={};o=!1;b("Banzai").post(j,e,d)}function F(){w||(w=new(b("CacheStorage"))("localstorage",""));return w}function c(a){m[a]||(m[a]=0),m[a]++,o=!0}function G(b,a,c,d,f,g,h,i){E([B(b,a,c,d,f,g,h)],i)}function H(a,b){p!==b&&(n.push(B(h,p,{dest_module:b,source_url:q,destination_url:a})),p=b,q=a)}function d(a,b){p!==b&&(r=null,H(a,b))}function f(a,b,c){G(b?"show_module":"hide_module",a,c)}function I(a){p=a}function J(){return p}function K(a){r===null&&(r=a,a!==null&&(E(n),n=[]))}e.exports={count:c,log:G,navigateTo:d,navigateWithinSession:H,toggleModule:f,setUUID:K,setNavigationModule:I,getNavigationModule:J}}),null);
__d("ZenonCallIDType",["randomInt"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a}function b(){return c("randomInt")(0,4294967294)+1}g.convertNumberToZenonCallID=a;g.generateZenonCallID=b}),98);
__d("ZenonCallSummaryUploader",["MarauderLogger","WebStorage","ZenonCallIDType","ZenonCallSummary","ZenonCallSummaryStore","ZenonInfraActionsLogger","ZenonPeerID","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=3*60*1e3,i="rtc_client_call_summary",j="webrtc";function k(a){var b=a.callID,e=a.callSummary;a=a.peerID;c("WebStorage").isLocalStorageQuotaExceeded()&&c("ZenonInfraActionsLogger").logCounter("local_storage_quota_exceeded");var f=d("ZenonCallIDType").convertNumberToZenonCallID(Number(b));c("ZenonInfraActionsLogger").updateCachedValues({callID:f});c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"[ZP] Attempting to upload CallSummary"});f=e.getMediaStats_DEBUG();if(c("gkx")("1847820")){var g;g=(g=(g=f.video)==null?void 0:(g=g.sender)==null?void 0:g.eqps)!=null?g:0;f=(f=(f=f.video)==null?void 0:(f=f.sender)==null?void 0:f.frames)!=null?f:0;var h=f!==0?g/f:0;c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"[zenon_senderVideoQp]:  eqps: "+g+", frames: "+f+", senderVideoQp: "+h})}g=babelHelpers["extends"]({call_id:b,channel_session_id:e.getDeviceID(),content:e.toString(),local_call_id:e.localCallID,peer_id:d("ZenonPeerID").convertPeerIDForLogging(a),sdp_format:e.getSdpFormat(),tag:"endcallstats"},e.getExtraInfo());d("MarauderLogger").log(i,j,g,void 0,void 0,void 0,void 0,"vital");c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"[ZP] Complete uploading CallSummary"})}function l(){var a=d("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance.getCallSummaries(),b=[];for(var e in a)for(var f in a[e]){var g=a[e][f];if(g.__z){var i=g.__t;if(Date.now()-i>h){i=c("ZenonCallSummary").fromJsonString(g.__d);i&&b.push({callID:f,callSummary:i,peerID:e})}}}return b}function a(){var a=l(),b=[];a.forEach(function(a){var c=a.callID,d=a.callSummary;a=a.peerID;k({callID:c,callSummary:d,peerID:a});b.push({callID:c,peerID:a})});d("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance.removeCallSummaries(b)}function b(a){var b=a.callID,c=a.peerID;k({callID:b,callSummary:a,peerID:c});d("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance.removeCallSummaries([{callID:b,peerID:c}])}g.getLoggableSummaries=l;g.logCallSummaries=a;g.logCallSummary=b}),98);
__d("ZenonParentCallSummaryLogProcessor",["ZenonActorHooks","ZenonCallSummary","ZenonCallSummaryStore","ZenonDismissReason","ZenonPeerID","ZenonSignalingProtocolUtils","pageID"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$2=a.protocol,c("ZenonSignalingProtocolUtils").isMwSupportedProtocol(a.protocol)&&(a.peerID=d("ZenonPeerID").ZenonMWPeerID),this.$1=new(c("ZenonCallSummary"))(a),b&&b({localCallID:this.$1.localCallID})}var b=a.prototype;b.$3=function(a){if(a!=null){a=a.deviceID;a=a==="mobile";this.$1.setIsPeerMobile(a)}};b.processEvent=function(a){switch(a.name){case"inviteResponded":this.$1.onInviteResponded();break;case"inviteReceived":this.$1.onInviteReceived();this.$3(a.remoteDeviceInfo);break;case"callEnded":this.$4(a);break;case"callAccepted":this.$1.onCallAccepted(a.trigger);d("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance.storeCallSummary(this.$1);break;case"popupOpened":this.$5(a);d("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance.storeCallSummary(this.$1);break}};b.$5=function(a){this.$1.setInitByPageID(c("pageID")),this.$1.setInitByAppID(d("ZenonActorHooks").ZenonActor.getAppID()),this.$1.onCallEnded(d("ZenonDismissReason").ZenonDismissReason.ClientError,!1,!0,a.isPopupBlocked?"PopupBlocked":"PopupPending"),d("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance.storeCallSummary(this.$1)};b.$4=function(a){if(c("ZenonSignalingProtocolUtils").isMwSupportedProtocol(this.$2)&&a.isRemoteEnded)return;var b=a.endCallReason,e=a.endCallSubreason;a=a.isRemoteEnded;if(b===d("ZenonDismissReason").ZenonDismissReason.OtherInstanceHandled&&a)return;this.$1.onCallEnded(b,a,!1,e);d("ZenonCallSummaryStore").ZenonCallSummaryStoreInstance.storeCallSummary(this.$1)};return a}();g["default"]=a}),98);
__d("ZenonParentQPLLogProcessor",["QPLUserFlow"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a.callID}var b=a.prototype;b.processEvent=function(a){switch(a.name){case"inviteReceived":c("QPLUserFlow").start(64225282,{instanceKey:+this.$1});break;case"callEnded":c("QPLUserFlow").endCancel(64225282,{instanceKey:+this.$1});break;case"callAccepted":c("QPLUserFlow").addPoint(64225282,"call_accepted",{instanceKey:+this.$1});break;case"inviteResponded":c("QPLUserFlow").addPoint(64225282,"invite_responded",{instanceKey:+this.$1});break;case"popupOpened":c("QPLUserFlow").endSuccess(64225282,{instanceKey:+this.$1});break}};return a}();g["default"]=a}),98);
__d("ZenonCollisionContext",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=null;a.groupThreadID!=null?b={id:a.groupThreadID,type:2}:a.peerID!=null&&(b={id:a.peerID,type:1});return b}f.getThreadIDAndTypeFromCollisionContext=a}),66);
__d("LazyLoadInstance",["promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h={LOADING:1,NOT_READY:0,READY:2};a=function(){function a(a,b){this.$1={instantiate:b,moduleReference:a,stage:h.NOT_READY}}var b=a.prototype;b.get=function(a){switch(this.$1.stage){case h.NOT_READY:c("promiseDone")(this.$2(this.$1),a);break;case h.LOADING:c("promiseDone")(this.$1.instancePromise,a);break;case h.READY:a(this.$1.instance);break}};b.getNow=function(){return this.$1.stage===h.READY?this.$1.instance:null};b.preload=function(){this.$1.stage===h.NOT_READY&&this.$2(this.$1)};b.$2=function(a){var b=this,c=a.instantiate;a=a.moduleReference;a=a.load().then(function(a){a=c(a);b.$1={instance:a,stage:h.READY};return a});this.$1={instancePromise:a,stage:h.LOADING};return a};return a}();g["default"]=a}),98);
__d("ZenonSignalingConstants",[],(function(a,b,c,d,e,f){"use strict";a="/rtc_multi";f.RTC_MULTI_MQTT_TOPIC=a}),66);
__d("ZenonMqttMWMessageSender",["FBMqttChannel","Promise","ZenonDebugLogger","ZenonMWMessageLogger","ZenonMWMessageReliabilityLogger","ZenonMWMessageTranslator","ZenonSignalingConstants","ZenonUserActionLogger","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=15e3;a=function(){function a(){}var e=a.prototype;e.waitForMqttConnected=function(){return new(b("Promise"))(function(a,b){if(c("FBMqttChannel").getConnectionState()==="Connected")a();else{c("ZenonUserActionLogger").logCheckpoint({checkpoint:"MQTT not connected, deferring sending MWS message"});c("ZenonUserActionLogger").startTimer("MQTT not connected");var d={onMQTTStateChanged:function(b){b==="Connected"&&(c("ZenonUserActionLogger").stopTimer({checkpointName:"MQTT connected after deferring sending MWS message",timerName:"MQTT not connected"}),c("FBMqttChannel").unsubscribeChannelEvents(d),window.clearTimeout(e),a())}},e=window.setTimeout(function(){c("FBMqttChannel").unsubscribeChannelEvents(d),c("ZenonUserActionLogger").stopTimer({checkpointName:"MQTT never connected. Current status: "+c("FBMqttChannel").getConnectionState(),timerName:"MQTT not connected"}),b("timeout")},h);c("FBMqttChannel").subscribeChannelEvents(d)}})};e.asyncSendMessage=function(a){var e=this,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:f=!0;h.next=3;return b("regeneratorRuntime").awrap(this.waitForMqttConnected()["catch"](function(a){c("ZenonUserActionLogger").logCheckpoint({checkpoint:"Not sending MWS message through MQTT because MQTT could not connect. Error: "+a}),f=!1}));case 3:if(f){h.next=5;break}return h.abrupt("return");case 5:g=c("ZenonDebugLogger").getInstance();d("ZenonMWMessageReliabilityLogger").logSendingMessage(a);g.logMWMessage("SENDING","MQTT",a);this.$2&&d("ZenonMWMessageLogger").logSentMessage(a,this.$2);h.prev=9;h.next=12;return b("regeneratorRuntime").awrap(c("FBMqttChannel").publish(d("ZenonSignalingConstants").RTC_MULTI_MQTT_TOPIC,JSON.stringify(a)).then(function(b){d("ZenonMWMessageReliabilityLogger").logSentMessage(a)},function(b){e.$3(a,b.toString())}));case 12:h.next=17;break;case 14:h.prev=14,h.t0=h["catch"](9),this.$3(a,h.t0.toString());case 17:case"end":return h.stop()}},null,this,[[9,14]])};e.$3=function(a,b){var e=c("ZenonDebugLogger").getInstance();b=b!=null?b:"MQTT Message Send Error";d("ZenonMWMessageReliabilityLogger").logSendMessageFailed(a);e.logSendMultiwayMessageFailure(b,a.jsonPayload.header.type)};e.sendMessage=function(a){a=d("ZenonMWMessageTranslator").toMWMessage(a);a!=null&&this.asyncSendMessage(a)};e.setMessageReceiver=function(a){this.$1=a};e.setLoggingEventHandler=function(a){this.$2=a};return a}();g["default"]=a}),98);
__d("ZenonXControllerSendRequest",["AsyncRequest","Promise","XGroupCallSendMessageController","XGroupCallSendRequestController","ZenonActorHooks","ZenonMWMessageReliabilityLogger","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=6e3;function i(a,e){return new(b("Promise"))(function(b,f){d("ZenonMWMessageReliabilityLogger").logSendingMessage(e),a.setMethod("POST").setAllowCrossPageTransition(!0).setHandler(function(a){d("ZenonMWMessageReliabilityLogger").logSentMessage(e),b(a)}).setErrorHandler(function(a){d("ZenonMWMessageReliabilityLogger").logSendRequestFailedFromHandler(e);a=a.getErrorDescription();a=new(c("err"))(a!=null?a.toString():"AsyncRequest error");f(a)}).setTimeoutHandler(h,function(){f("Timeout")}),a.send()})}function a(a){var b=c("XGroupCallSendMessageController").getURIBuilder();c("gkx")("2028434")&&b.setFBID("av",d("ZenonActorHooks").ZenonActor.getID());b=b.getURI();b=new(c("AsyncRequest"))(b).setData({message:JSON.stringify(a)});return i(b,a)}function e(a){var b=c("XGroupCallSendRequestController").getURIBuilder();c("gkx")("2028434")&&b.setFBID("av",d("ZenonActorHooks").ZenonActor.getID());b=b.getURI();b=new(c("AsyncRequest"))(b).setData({request:JSON.stringify(a)});return i(b,a)}g.sendMessage=a;g.sendRequest=e}),98);
__d("ZenonXControllerMWMessageSender",["ZenonDebugLogger","ZenonMWMessageLogger","ZenonMWMessageReliabilityLogger","ZenonMWMessageTranslator","ZenonMWMessageTypes","ZenonMWTranslatorUtils","ZenonXControllerSendRequest","gkx","regeneratorRuntime","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}var e=a.prototype;e.handleResponse=function(a){a=a.payload;if(a==null)return;var b=a.header||null;a=a.body||null;var e=c("ZenonDebugLogger").getInstance();if(b!=null&&a!=null){b=c("ZenonMWTranslatorUtils").createMWMessage(b,a);d("ZenonMWMessageReliabilityLogger").logStartProcessingResponse(b);e.logMWMessage("RECEIVED","XController",b);c("gkx")("2054568")&&this.$2&&d("ZenonMWMessageLogger").logReceivedMessage(b,this.$2);d("ZenonMWMessageReliabilityLogger").logReceivedMessage(b);a=d("ZenonMWMessageTranslator").toSignalingMessage(b);if(this.$1!=null)this.$1(a),d("ZenonMWMessageReliabilityLogger").logProcessingMessage(b);else throw c("unrecoverableViolation")("Should never have null message receiver","rtc_www")}};e.asyncSendMessage=function(a){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=c("ZenonDebugLogger").getInstance();e.logMWMessage("SENDING","XController",a);this.$2&&d("ZenonMWMessageLogger").logSentMessage(a,this.$2);h.prev=3;if(!this.isResponseExpected(a)){h.next=11;break}h.next=7;return b("regeneratorRuntime").awrap(d("ZenonXControllerSendRequest").sendRequest(a));case 7:f=h.sent;this.handleResponse(f);h.next=13;break;case 11:h.next=13;return b("regeneratorRuntime").awrap(d("ZenonXControllerSendRequest").sendMessage(a));case 13:h.next=20;break;case 15:h.prev=15,h.t0=h["catch"](3),g=h.t0!=null?h.t0.toString():"Message Send Error",d("ZenonMWMessageReliabilityLogger").logSendMessageFailed(a),e.logSendMultiwayMessageFailure(g,a.jsonPayload.header.type);case 20:case"end":return h.stop()}},null,this,[[3,15]])};e.isResponseExpected=function(a){switch(a.jsonPayload.header.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_EVENT:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UNSUBSCRIBE:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UPDATE:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CONNECT:return!0;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.RING:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.NOTIFY:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CONFERENCE_STATE:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.HANGUP:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DISMISS:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ADD_PARTICIPANTS:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SUBSCRIPTION:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.REMOVE_PARTICIPANTS:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.PING:case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.P2P_PROTOCOL:return!1;default:return!1}};e.sendMessage=function(a){a=d("ZenonMWMessageTranslator").toMWMessage(a);a!=null&&this.asyncSendMessage(a)};e.setMessageReceiver=function(a){this.$1=a};e.setLoggingEventHandler=function(a){this.$2=a};return a}();g["default"]=a}),98);
__d("ZenonHybridMWMessageSender",["FBLogger","ZenonActorHooks","ZenonGraphQLMWMessageSender","ZenonInfraActionsLogger","ZenonMWMessageTranslator","ZenonMWMessageTypes","ZenonMqttMWMessageSender","ZenonXControllerMWMessageSender"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=new(c("ZenonXControllerMWMessageSender"))(),this.$2=new(c("ZenonGraphQLMWMessageSender"))(),this.$3=new(c("ZenonMqttMWMessageSender"))(),this.$4=!1,this.$4=d("ZenonActorHooks").ZenonActor.isPage()}var b=a.prototype;b.sendMessage=function(a){var b=d("ZenonMWMessageTranslator").toMWMessage(a),e=b==null?void 0:b.jsonPayload.header.type;if(a.getHeader().remoteSignalingID==null&&e!=null&&e!==d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN){c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"[ZP][DROP] No remoteSignalingID in message: "+e});c("FBLogger")("rtc_www").warn("[ZP][DROP] No remoteSignalingID in message: "+e);return}b!=null&&(this.$4?this.$2.asyncSendMessage(b):(this.$3.asyncSendMessage(b),e!==d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE&&this.$2.asyncSendMessage(b)))};b.setMessageReceiver=function(a){this.$1.setMessageReceiver(a),this.$2.setMessageReceiver(a)};b.setLoggingEventHandler=function(a){this.$1.setLoggingEventHandler(a),this.$2.setLoggingEventHandler(a)};return a}();g["default"]=a}),98);
__d("ZenonParentSignalingClient",["ZenonDebugLogger","ZenonSignalingTypes","recoverableViolation","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e){var f=this;this.remoteSignalingID=null;this.$4="init";this.$6=null;this.$7=null;this.$8=function(){};this.$9=function(a,b,d){c("ZenonDebugLogger").getInstance().logStateMachine("ParentSignalingClient",f.$4,"received "+a.eventName,f.$1.getSignalingID());switch(a.eventName){case"inviteRequest":f.$11(a,b,d);break;case"remoteSdpRequest":f.$12(a,b);break;case"terminateRequest":f.$13(a,b,d);break}};this.$1=a;this.$3=d;this.$5=e;this.$2=b;b.setReceiver(this.$9);c("ZenonDebugLogger").getInstance().startQPL(64234815,+a.getSignalingID())}var b=a.prototype;b.setSignalingEventHandlers=function(a){if(this.$6!=null){c("recoverableViolation")("setSignalingEventHandlers should only be called once, to avoid accidentally losing handlers.","rtc_www");return}this.$6=a};b.setLoggingEventHandler=function(a){this.$8=a};b.getSignalingModel=function(){return this.$1};b.sendDismiss=function(a){this.$4="terminated";a={eventName:"terminateRequest",fromJoinResponse:!1,reason:a,shouldInformPeer:!0};this.$10(a)};b.receiveMessage=function(a){this.$2.receiveMessage(a)};b.isTerminated=function(){return this.$4==="terminated"};b.sendAnswerIntent=function(){if(this.$4==="inviteAcknowledged"){this.$4="answered";var a={eventName:"answerIntentRequest"};this.$10(a)}else throw c("unrecoverableViolation")("sendAnswerIntent called in unexpected state "+this.$4,"rtc_www")};b.respondToInvite=function(a){if(this.$4==="inviteReceived"){if(this.$7==null)throw c("unrecoverableViolation")("respondToInvite called without inviteMessageId being populated first","rtc_www");this.$4="inviteAcknowledged";a={ackMessageId:this.$7,eventName:"inviteResponse",status:a};this.$10(a)}else throw c("unrecoverableViolation")("respondToInvite called in unexpected state "+this.$4,"rtc_www")};b.initiateClientRenegotiation=function(a){throw c("unrecoverableViolation")("initiateClientRenegotiation called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendClientEvent=function(a){throw c("unrecoverableViolation")("sendClientEvent called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendInvite=function(a,b){throw c("unrecoverableViolation")("sendInvite called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendSdp=function(a,b){throw c("unrecoverableViolation")("sendSdp called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendIceCandidate=function(a){throw c("unrecoverableViolation")("sendIceCandidate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendMediaUpdate=function(a){throw c("unrecoverableViolation")("sendMediaUpdate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendAddParticipantsMessage=function(a){throw c("unrecoverableViolation")("sendAddParticipantsMessage called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendRemoveParticipantsRequest=function(a){throw c("unrecoverableViolation")("sendRemoveParticipantsRequest called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendUsersApprovalRequest=function(a,b){throw c("unrecoverableViolation")("sendUsersApprovalRequest called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendStateSyncUnsubscribe=function(a){throw c("unrecoverableViolation")("sendStateSyncUnsubscribe called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendStateSyncUpdate=function(a,b){throw c("unrecoverableViolation")("sendStateSyncUpdate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendSubscriptionRequest=function(a){throw c("unrecoverableViolation")("sendSubscriptionRequest called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendClientInfo=function(a){throw c("unrecoverableViolation")("sendClientInfo called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.sendGenericDataMessage=function(a,b,d){throw c("unrecoverableViolation")("sendGenericDataMessage called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};b.$10=function(a){c("ZenonDebugLogger").getInstance().logStateMachine("ParentSignalingClient",this.$4,"sending "+a.eventName,this.$1.getSignalingID()),this.$3.sendEvent(a)};b.$11=function(a,b,c){this.$4==="init"&&(this.$4="inviteReceived",this.$7=b,this.$5(a,c,this))};b.$13=function(a,b,c){if(this.$4!=="terminated"){this.$4="terminated";c={ackMessageId:b,eventName:"dismissResponse"};this.$3.sendEvent(c);if(this.$6&&this.$6.onDismissReceived){this.$6.onDismissReceived(this.$1.getSignalingID(),a.reason,(b=a.subreason)!=null?b:null)}}};b.$12=function(a,b){b={ackMessageId:b,acknowledgedVersion:a.sdp.version,eventName:"remoteSdpResponse",negotiateType:a.negotiateType,status:d("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus.OK,type:a.sdp.type};this.$3.sendEvent(b)};return a}();g["default"]=a}),98);
__d("ZenonParentCallsManager",["BaseEventEmitter","JSResource","LazyLoadInstance","ZenonCallLogger","ZenonCallsModelTypes","ZenonCollisionContext","ZenonDismissReason","ZenonHybridMWMessageSender","ZenonParentCallSummaryLogProcessor","ZenonParentQPLLogProcessor","ZenonParentSignalingClient","ZenonSignalingProtocol","gkx","recoverableViolation","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(e,a);function e(b){var e;e=a.call(this)||this;e.$ZenonParentCallsManager4=new Map();e.$ZenonParentCallsManager5=new Set();e.onInviteReceived=function(a,b,f){var g,h=f.getSignalingModel().getSignalingID();f.setSignalingEventHandlers({onDismissReceived:e.onDismissReceived});var i=a.inviterID,j=a.otherParticipants,k=a.requestingVideo;a=a.roomInfo;var l="zenon_incoming_call_dialog",m=e.$ZenonParentCallsManager6({callID:h,callTrigger:l,isCaller:!1,isVideo:k,peerID:i,protocol:b});m.log({name:"inviteReceived"});l=e.$ZenonParentCallsManager3.isSupportedClientForProtocol(b);var n=l?"OK":"NOT_SUPPORTED";f.respondToInvite(n);m.log({name:"inviteResponded"});n={thread:{id:"0",type:2},type:"thread"};if(((g=a.context)==null?void 0:g.groupThreadID)||((g=a.context)==null?void 0:g.peerID)){n={thread:(g=d("ZenonCollisionContext").getThreadIDAndTypeFromCollisionContext(a.context))!=null?g:n.thread,type:"thread"}}else((g=a.room)==null?void 0:g.linkHash)!=null&&((g=a.room)==null?void 0:g.roomName)!=null&&(n={room:a.room,type:"room"});a={context:n,controllerParams:{callContext:a.name,callID:h,configuration:b,serverInfoData:(n=(g=a.context)==null?void 0:g.serverInfoData)!=null?n:null},inviterID:i,isClientPermissableRing:l,onAccept:function(a,d){var g=d.isPopupBlocked;d=d.trigger;m.log({name:"callAccepted",trigger:d});b===c("ZenonSignalingProtocol").P2P&&e.$ZenonParentCallsManager2.get(function(a){a.storeOfferForBackwardsCompat(i,h)});f.sendAnswerIntent();e.$ZenonParentCallsManager7(a,{callID:h,callTrigger:d,isPopupBlocked:g,isVideo:k,peerID:i,protocol:b})},onDecline:function(a,b){b===void 0&&(b=null),e.onDecline(h,m,a,b)},otherParticipants:j,requestingVideo:k,ringID:h};e.emit("incomingRing",a)};e.onDismissReceived=function(a,b){var c=d("ZenonDismissReason").dismissReasonToCancelReason(b);c={reason:c,ringID:a};e.emit("ringCancel",c);c=e.$ZenonParentCallsManager4.get(a);c!=null&&(c.log({name:"dismissRecv"}),c.log({endCallReason:b,isRemoteEnded:!0,name:"callEnded"}))};e.$ZenonParentCallsManager3=b;e.$ZenonParentCallsManager2=new(c("LazyLoadInstance"))(c("JSResource")("ZenonSignalingParentTransport").__setRef("ZenonParentCallsManager"),function(a){return new a()});var f=new(c("ZenonHybridMWMessageSender"))();e.$ZenonParentCallsManager1=new(c("LazyLoadInstance"))(c("JSResource")("ZenonSignalingClientManager").__setRef("ZenonParentCallsManager"),function(a){return new a(c("ZenonParentSignalingClient"),e.onInviteReceived,f)});return e}var f=e.prototype;f.startOutgoingCallIntent=function(a,b){var c=b.callID,d=b.callTrigger,e=b.isVideo,f=b.peerID,g=b.protocol;this.$ZenonParentCallsManager6({callID:c,callTrigger:d,isCaller:!0,isVideo:e,peerID:f,protocol:g});this.$ZenonParentCallsManager7(a,b)};f.$ZenonParentCallsManager6=function(a){var b=a.callID,d=a.callTrigger,e=a.isCaller,f=a.isVideo,g=a.peerID;a=a.protocol;var h=this.$ZenonParentCallsManager4.get(b);!h?(h=new(c("ZenonCallLogger"))({callID:b,callTrigger:d,isCaller:e,isVideo:f,peerID:g,protocol:a},c("gkx")("1536863")?[c("ZenonParentCallSummaryLogProcessor"),c("ZenonParentQPLLogProcessor")]:[c("ZenonParentCallSummaryLogProcessor")]),this.$ZenonParentCallsManager4.set(b,h)):c("recoverableViolation")("Call logger key collision in parentCallsManager for callID: "+b,"rtc_www");return h};f.$ZenonParentCallsManager7=function(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=c.alohaEscalatedMW,f=c.callID,g=c.isPopupBlocked;this.$ZenonParentCallsManager2.get(function(b){b.verificationNonce=a});this.$ZenonParentCallsManager5.add(f);h=this.$ZenonParentCallsManager4.get(f);if(!(h!=null)){j.next=11;break}h.log({isPopupBlocked:g,name:"popupOpened"});if(!(e!=null)){j.next=11;break}j.next=9;return b("regeneratorRuntime").awrap(e);case 9:i=j.sent,i&&h.log({endCallReason:d("ZenonDismissReason").ZenonDismissReason.OtherInstanceHandled,endCallSubreason:"forceP2POverMWForAloha",isRemoteEnded:!1,name:"callEnded"});case 11:case"end":return j.stop()}},null,this)};f.initListeners=function(a){var b=this;for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e.subscribe(function(a){return b.onMessageReceived(a)},function(a){return b.onRawP2PMessageReceived(a)},function(a){return b.onRawMWMessageReceived(a)})}};f.onMessageReceived=function(a){var b=a.getHeader().signalingID;if(b!=null&&this.$ZenonParentCallsManager5.has(b))return;this.$ZenonParentCallsManager1.get(function(b){b.receiveMessage(a)})};f.onRawP2PMessageReceived=function(a){this.$ZenonParentCallsManager2.get(function(b){b.enqueueRawP2PMessage(a)})};f.onRawMWMessageReceived=function(a){this.$ZenonParentCallsManager2.get(function(b){b.enqueueRawMWMessage(a)})};f.onDecline=function(a,b,e,f){f===void 0&&(f=null),this.$ZenonParentCallsManager1.get(function(g){g=g.getSignalingClient(a);if(g){var h=d("ZenonDismissReason").endCallToDismissReason(e);e!=="NoAnswerTimeout"&&e!=="VersionUnsupported"&&f!==d("ZenonCallsModelTypes").ZenonEndCallSubreason.CallsBlocked&&g.sendDismiss(h);b.log({endCallReason:h,endCallSubreason:f==null?null:f,isRemoteEnded:!1,name:"callEnded"})}else c("recoverableViolation")("signaling client should be defined","rtc_www")})};f.removeListeners=function(a){for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.unsubscribe()}};return e}(c("BaseEventEmitter"));g["default"]=a}),98);
__d("ZenonP2PMessageValidator",["ZenonActorHooks","ZenonP2PMessageTypes","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=JSON.parse(a);var b=a.call_id,e=a.from,f=a.id,g=a.msg_type,h=a.payload,i=a.source,j=a.to;a=a.type;if(j!=null&&j.toString()!==d("ZenonActorHooks").ZenonActor.getID())throw c("err")("P2P message.to field "+j+" does not match logged in user ID "+d("ZenonActorHooks").ZenonActor.getID()+" for msg_type "+g);if(e&&b&&h){j={call_id:b,from:e,id:f,msg_type:g,payload:h,source:i,type:a};return j}else throw c("err")("P2P message does not have valid from, call_id, and payload fields")}function b(a){if(a){var b=a.msg_type;switch(b){case d("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType.OFFER:return i(a);case d("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType.HANG_UP:return j(a);case d("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType.ICE_CANDIDATE:return h(a);case d("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType.OTHER_DISMISS:return k(a)}}return null}function h(a){var b=a.from,c=a.payload;a=a.source;c=JSON.parse(c);var e=c.call_id,f=c.capability,g=c.label,h=c.msg_id,i=c.sdp,j=c.sdp_line_idx,k=c.sdp_mid;c=c.version;e={call_id:e,capability:f,from:b,label:g,msg_id:h,sdp:i,sdp_line_idx:j,sdp_mid:k,source:a,type:d("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType.ICE_CANDIDATE,version:c};return e}function i(a){var b,c,e,f,g=a.from,h=a.payload;a=a.source;h=JSON.parse(h);var i=h.call_id,j=h.calltype,k=h.capability;b=(b=h.escalation_conference_name)!=null?b:null;c=(c=h.experiments)!=null?c:[];e=(e=h.extraParams)!=null?e:[];f=(f=h.fbexp)!=null?f:"";var l=h.handlescollision!==void 0?h.handlescollision:!1,m=h.offer_escalation_support!==void 0?h.offer_escalation_support:!1,n=h.msg_id,o=h.sdp;h=h.videoon;i={call_id:i,calltype:j,capability:k,escalation_conference_name:b,experiments:c,extraParams:e,fbexp:f,from:g,handlescollision:l,msg_id:n,offer_escalation_support:m,sdp:o,source:a,type:d("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType.OFFER,videoon:h};return i}function j(a){var b=a.from,c=a.payload;a=a.source;c=JSON.parse(c);var e=c.call_id,f=c.capability,g=c.msg_id,h=c.reason;c=c.subreason;e={call_id:e,capability:f,from:b,msg_id:g,reason:h,source:a,subreason:c,type:d("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType.HANG_UP};return e}function k(a){var b=a.from,c=a.payload;a=a.source;c=JSON.parse(c);var e=c.call_id,f=c.capability;c=c.msg_id;e={call_id:e,capability:f,from:b,msg_id:c,source:a,type:d("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType.OTHER_DISMISS};return e}g.getValidP2PMessage=a;g.transformP2PMessage=b}),98);
__d("RTWebSignalingListener",["FBLogger","FBMqttChannel","ZenonDebugLogger","ZenonMWMessageReliabilityLogger","ZenonMWMessageTranslator","ZenonP2PMessageTranslator","ZenonP2PMessageValidator","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}var b=a.prototype;b.subscribe=function(a,b,e){var f=this;c("FBMqttChannel").subscribe("/webrtc",function(e){var g=c("ZenonDebugLogger").getInstance(),h=d("ZenonP2PMessageValidator").getValidP2PMessage(e),i=d("ZenonP2PMessageValidator").transformP2PMessage(h);f.$1(e,b);if(i){e=d("ZenonP2PMessageTranslator").toSignalingMessage(i);e&&(g.logP2PMessageReceived(h),a(e),g.logP2PMessageProcessed(h))}});c("FBMqttChannel").subscribe("/rtc_multi",function(b){try{var g=JSON.parse(b),h=c("ZenonDebugLogger").getInstance();d("ZenonMWMessageReliabilityLogger").logReceivedMessage(g);h.logMWMessage("RECEIVED","MQTT",g);h=d("ZenonMWMessageTranslator").toSignalingMessage(g);a(h);e&&f.$2(b,e);d("ZenonMWMessageReliabilityLogger").logProcessingMessage(g)}catch(a){c("FBLogger")("rpweb").catching(a).warn("Error receiving MQTT message from /rtc_multi topic")}})};b.unsubscribe=function(){c("FBMqttChannel").unsubscribeAll("/webrtc"),c("FBMqttChannel").unsubscribeAll("/rtc_multi")};b.$1=function(a,b){try{a=JSON.parse(a);b(a)}catch(a){c("recoverableViolation")("Signaling messages should be json parsable. error:"+a,"rtweb")}};b.$2=function(a,b){try{a=JSON.parse(a);b(a)}catch(a){c("recoverableViolation")("Signaling messages should be json parsable. error:"+a,"rtweb")}};return a}();g["default"]=a}),98);
__d("FBRTCCallSummaryUploader",["Banzai","FBRTCCallSummary","FBRTCCallSummaryStore","ZenonCallSummaryUploader","cr:1645710"],(function(a,b,c,d,e,f,g){function a(){var a=c("FBRTCCallSummaryStore").getInstance();c("Banzai").subscribe(c("Banzai").SEND,function(){d("ZenonCallSummaryUploader").logCallSummaries(),b("cr:1645710")==null?void 0:b("cr:1645710").logCallSummaries(),c("FBRTCCallSummary").logSavedSummaries(a)})}g.init=a}),98);
__d("WebPerfDeviceInfoLogFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1871697");c=b("FalcoLoggerInternal").create("web_perf_device_info_log",a);e.exports=c}),null);
__d("XDeviceClassRealtimeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/web_perf/get_perf_level/",{})}),null);
__d("WebDevicePerfInfoLogging",["AsyncTypedRequest","JSScheduler","Promise","WebDevicePerfInfoData","WebPerfDeviceInfoLogFalcoEvent","XDeviceClassRealtimeController","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=document.createElement("canvas");b=b.getContext("webgl")||b.getContext("experimental-webgl");if(!b)return;var c=b.getExtension("WEBGL_debug_renderer_info");if(!c)return;var d=b.getParameter(c.UNMASKED_RENDERER_WEBGL);b=b.getParameter(c.UNMASKED_VENDOR_WEBGL);a.gpu_vendor=b;a.gpu_renderer=d}function i(){var a=window.navigator,b={};a&&a.hardwareConcurrency!==void 0&&(b.cpu_cores=a.hardwareConcurrency);a&&a.deviceMemory!==void 0&&(b.ram=a.deviceMemory);c("WebDevicePerfInfoData").needsFullUpdate&&h(b);return b}function j(){var a=i();c("WebPerfDeviceInfoLogFalcoEvent").log(function(){var b;return{cpu_cores:(b=a.cpu_cores)!=null?b:null,ram:(b=a.ram)!=null?b:null,gpu_renderer:(b=a.gpu_renderer)!=null?b:null,gpu_vendor:(b=a.gpu_vendor)!=null?b:null}})}function k(){var a,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:a=i();e.next=3;return b("regeneratorRuntime").awrap(new(c("AsyncTypedRequest"))(c("XDeviceClassRealtimeController").getURIBuilder().getURI()).setData(a).promisePayload());case 3:d=e.sent;return e.abrupt("return",d.devicePerfClassLevel);case 5:case"end":return e.stop()}},null,this)}function a(){(c("WebDevicePerfInfoData").needsFullUpdate||c("WebDevicePerfInfoData").needsPartialUpdate)&&d("JSScheduler").scheduleSpeculativeCallback(j)}function e(){return new(b("Promise"))(function(a,b){c("WebDevicePerfInfoData").needsFullUpdate||c("WebDevicePerfInfoData").needsPartialUpdate?d("JSScheduler").scheduleSpeculativeCallback(function(){k().then(a)["catch"](b)}):b()})}g.doLog=a;g.doLogPromise=e}),98);
__d("AcfToastImpressionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1873550");c=b("FalcoLoggerInternal").create("acf_toast_impression",a);e.exports=c}),null);
__d("ClientConsistencyFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1764786");c=b("FalcoLoggerInternal").create("client_consistency",a);e.exports=c}),null);
__d("FalcoLoggerTransports",["AnalyticsCoreData","Banzai","JSResource","ODS","PersistedQueue","Queue","WebSession","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=5*1024,i=60*1e3,j=1e3,k="falco:",l=new(c("Queue"))(),m=[],n=0,o,p=!1,q=!1,r=!1,s=!0;function t(a,b){var c=b.item.extra.length;n+c>h&&(clearTimeout(o),u());m.push([a,b]);n+=c}function u(){o=null;p=!1;var a=m;l.enqueue(function(b){return b.log(a.map(function(a){return a[1].item}),function(b){for(var c=0;c<a.length;c++){var d=a[c],e=d[0];d=d[1];e.markItem(d,b)}})});m=[];n=0}function v(a){return{events:a.map(function(a){return{name:a.name,extra:a.extra,rate:a.policy.r,time:a.time/1e3}})}}function w(a){return Object.freeze({deviceId:c("AnalyticsCoreData").device_id,sessionId:a,appId:c("AnalyticsCoreData").app_id,pushPhase:c("AnalyticsCoreData").push_phase})}function x(a,b){y("planes.banzai.write",a.length);for(var e=0;e<a.length;e++){var f,g=a[e];c("Banzai").post(k+g.name,(f={},f.e=g.extra,f.r=g.policy.r,f.d=c("AnalyticsCoreData").device_id,f.s=d("WebSession").getId(),f.t=g.time*1e3,f),b)}}function y(a,b){d("ODS").bumpEntityKey(1344,"falco.fabric.www."+c("AnalyticsCoreData").push_phase,a,b)}var z={log:function(a,b){x(a,c("Banzai").BASIC),b(!0)},logImmediately:function(a,b){x(a,c("Banzai").VITAL),b(!0)},logCritical:function(a,b){x(a,{signal:!0,retry:!0}),b(!0)}};function A(){if(q)return;c("JSResource").loadAll([c("JSResource")("TransportSelectingClientSingleton").__setRef("FalcoLoggerTransports"),c("JSResource")("RequestStreamCommonRequestStreamCommonTypes").__setRef("FalcoLoggerTransports")],function(a,b){var e=b.FlowStatus,f;b={onTermination:function(a){a.message==="Stream closed"?(l.stop(!0),q=!1):(s=!1,l.start(function(a){return a(z)}))},onFlowStatus:function(a){a===e.Started&&l.start(function(a){return a({log:function(b,a){y("planes.bladerunner.write",b.length);b=JSON.stringify(v(b));f&&(c("AnalyticsCoreData").enable_ack?c("promiseDone")(f.amendWithAck(b),function(){return a(!0)}):(f.amendWithoutAck(b),a(!0)))},logImmediately:function(b,a){this.log(b,a)},logCritical:function(b,a){this.log(b,a)}})})}};c("promiseDone")(a.requestStream({method:"Falco"},JSON.stringify(w(d("WebSession").getId())),b,{requestId:""}).then(function(a){f=a})["catch"](function(a){l.stop(!0),q=!1}))});q=!0}function B(a){return c("AnalyticsCoreData").enable_bladerunner&&s&&a.s===1}function a(){if(r)return;r=!0;c("PersistedQueue").setHandler("falco_queue_log",function(a){var b;while(b=a.dequeueItem())(function(b){B(b.item.policy)?(A(),o==null&&(o=setTimeout(u,i)),t(a,b)):z.log([b.item],function(c){return a.markItem(b,c)})})(b)});c("PersistedQueue").setHandler("falco_queue_immediately",function(a){var b;while(b=a.dequeueItem())(function(b){B(b.item.policy)?(A(),(o==null||!p)&&(clearTimeout(o),o=setTimeout(u,j),p=!0),t(a,b)):z.logImmediately([b.item],function(c){return a.markItem(b,c)})})(b)});c("PersistedQueue").setHandler("falco_queue_critical",function(a){var b;while(b=a.dequeueItem())(function(b){var c=b.item;B(c.policy)?(A(),l.enqueue(function(d){return d.logCritical([c],function(c){return a.markItem(b,c)})})):z.logCritical([c],function(c){return a.markItem(b,c)})})(b)})}g.attach=a}),98);
__d("FleetBeaconStates",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.getName=function(){return"initial"};b.getFleetBeaconRunner=function(){return this.$1};b.prepareFleetBeaconSucceed=function(){throw new Error("Invalid transition")};b.prepareFleetBeaconFailed=function(){throw new Error("Invalid transition")};b.subscribeIssued=function(){throw new Error("Invalid transition")};b.subscribeSuccessSignalReceived=function(){throw new Error("Invalid transition")};b.publishIssued=function(){throw new Error("Invalid transition")};b.publishFailed=function(){throw new Error("Invalid transition")};b.payloadReceived=function(){throw new Error("Invalid transition")};b.waitForPublishTimeout=function(){throw new Error("Invalid transition")};b.subscribeTimeout=function(){throw new Error("Invalid transition")};b.payloadTimeout=function(){throw new Error("Invalid transition")};b.cleanUpFinish=function(){throw new Error("Invalid transition")};return a}();b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.getName=function(){return"preparing"};c.prepareFleetBeaconSucceed=function(){var b=this;return{newState:new g(a.prototype.getFleetBeaconRunner.call(this)),action:function(){a.prototype.getFleetBeaconRunner.call(b).runFleetBeaconTest()}}};c.prepareFleetBeaconFailed=function(){var b=this;return{newState:new m(a.prototype.getFleetBeaconRunner.call(this)),action:function(){b.getFleetBeaconRunner().cleanUpFleetBeacon()}}};return b}(a);var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"before_subscribe"};c.subscribeIssued=function(){var a=this;return{newState:new h(b.prototype.getFleetBeaconRunner.call(this)),action:function(){b.prototype.getFleetBeaconRunner.call(a).startSubscribeTimer()}}};return a}(a),h=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"subscribe_issued"};c.subscribeSuccessSignalReceived=function(){var a=this;return{newState:new i(b.prototype.getFleetBeaconRunner.call(this)),action:function(){b.prototype.getFleetBeaconRunner.call(a).waitForNextPublish()}}};c.subscribeTimeout=function(){var a=this;return{newState:new k(b.prototype.getFleetBeaconRunner.call(this)),action:function(){a.getFleetBeaconRunner().cleanUpFleetBeacon()}}};return a}(a),i=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"waiting_to_publish"};c.waitForPublishTimeout=function(){var a=this;return{newState:new j(b.prototype.getFleetBeaconRunner.call(this)),action:function(){b.prototype.getFleetBeaconRunner.call(a).publish(),b.prototype.getFleetBeaconRunner.call(a).startPayloadTimer()}}};return a}(a),j=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"publish_issued"};c.publishFailed=function(){var a=this;return{newState:new m(b.prototype.getFleetBeaconRunner.call(this)),action:function(){a.getFleetBeaconRunner().cleanUpFleetBeacon()}}};c.payloadReceived=function(){var a=this,c,d;(function(){});b.prototype.getFleetBeaconRunner.call(this).isLastPayload()?(c=new l(b.prototype.getFleetBeaconRunner.call(this)),d=function(){a.getFleetBeaconRunner().cleanUpFleetBeacon()}):(c=new i(b.prototype.getFleetBeaconRunner.call(this)),d=function(){b.prototype.getFleetBeaconRunner.call(a).waitForNextPublish()});return{newState:c,action:d}};c.payloadTimeout=function(){var a=this;return{newState:new k(b.prototype.getFleetBeaconRunner.call(this)),action:function(){a.getFleetBeaconRunner().cleanUpFleetBeacon()}}};return a}(a),k=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"failed"};c.cleanUpFinish=function(){return{newState:new n(b.prototype.getFleetBeaconRunner.call(this)),action:function(){}}};return a}(a),l=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"succeed"};c.cleanUpFinish=function(){return{newState:new n(b.prototype.getFleetBeaconRunner.call(this)),action:function(){}}};return a}(a),m=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"aborted"};c.cleanUpFinish=function(){return{newState:new n(b.prototype.getFleetBeaconRunner.call(this)),action:function(){}}};return a}(a),n=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"finish"};return a}(a);f.FleetBeaconState=a;f.FleetBeaconPreparingState=b;f.FleetBeaconBeforeSubscribeState=g;f.FleetBeaconSubscribedIssuedState=h;f.FleetBeaconWaitingToPublishState=i;f.FleetBeaconPublishIssuedState=j;f.FleetBeaconFailedState=k;f.FleetBeaconSucceedState=l;f.FleetBeaconAbortedState=m;f.FleetBeaconFinishState=n}),66);
__d("FleetBeaconRunner",["FleetBeaconStates","clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a;this.$2=new(d("FleetBeaconStates").FleetBeaconState)(this);var b=new(d("FleetBeaconStates").FleetBeaconPreparingState)(this);this.$1.cleanPreviousFleetBeaconResult();this.$6(function(){return{newState:b,action:function(){}}});this.$3=0;this.$1.setFleetBeaconRunner(this)}var b=a.prototype;b.getPublishTimes=function(){return this.$3};b.prepareFleetBeaconTest=function(){this.$1.prepareFleetBeaconTest()};b.runFleetBeaconTest=function(){var a=this;this.$6(function(){return a.$2.subscribeIssued()});this.$7()};b.$7=function(){this.$1.subscribe()};b.publish=function(){this.$1.publish()};b.isLastPayload=function(){return this.$3>=this.$1.publishWaitIntervalsMS().length};b.waitForNextPublish=function(){var a=this,b=this.$1.publishWaitIntervalsMS()[this.$3];this.$3+=1;b===0?this.$8():c("setTimeout")(function(){a.$8()},b)};b.startSubscribeTimer=function(){var a=this,b=this.$1.subscribeTimeoutIntervalMS();this.$4=c("setTimeout")(function(){a.$9()},b)};b.startPayloadTimer=function(){var a=this,b=this.$1.payloadTimeoutIntervalMS();this.$5=c("setTimeout")(function(){a.$10()},b)};b.cleanUpFleetBeacon=function(){this.$1.cleanUpFleetBeacon()};b.onCleanUpFinish=function(){var a=this;this.$6(function(){return a.$2.cleanUpFinish()})};b.$8=function(){var a=this;this.$6(function(){return a.$2.waitForPublishTimeout()})};b.$9=function(){var a=this;this.$6(function(){return a.$2.subscribeTimeout()})};b.$10=function(){var a=this;this.$6(function(){return a.$2.payloadTimeout()})};b.onPrepareFleetBeaconSuccess=function(){var a=this;this.$6(function(){return a.$2.prepareFleetBeaconSucceed()})};b.onPrepareFleetBeaconFailed=function(){var a=this;this.$6(function(){return a.$2.prepareFleetBeaconFailed()})};b.onSubscribe=function(){var a=this;c("clearTimeout")(this.$4);this.$6(function(){return a.$2.subscribeSuccessSignalReceived()})};b.onPayloadReceived=function(){var a=this;c("clearTimeout")(this.$5);this.$6(function(){return a.$2.payloadReceived()})};b.onPublishFailed=function(){var a=this;c("clearTimeout")(this.$5);this.$6(function(){return a.$2.publishFailed()})};b.$6=function(a){a=a();var b=this.$2;this.$2=a.newState;var c=this.$2;this.$11(b,c);a.action()};b.$11=function(a,b){this.$1.onFleetBeaconStateTransition(a,b)};return a}();g["default"]=a}),98);
__d("FleetBeaconStateTransitionListener",[],(function(a,b,c,d,e,f){a=function(){function a(){}var b=a.prototype;b.onFleetBeaconStateTransition=function(a,b,c,d){throw new Error("Require implementation")};b.cleanState=function(){throw new Error("Require implementation")};return a}();f["default"]=a}),66);
__d("FleetBeaconTestBase",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=null,this.$2=[]}var b=a.prototype;b.addStateTransitionListener=function(a){this.$2.push(a)};b.cleanPreviousFleetBeaconResult=function(){this.$2.forEach(function(a){a.cleanState()})};b.getNumberOfPublishers=function(){var a;return(a=(a=this.$1)==null?void 0:a.getPublishTimes())!=null?a:-1};b.getTestID=function(){throw new Error("Require implementation")};b.setFleetBeaconRunner=function(a){this.$1=a};b.prepareFleetBeaconTest=function(){throw new Error("Require implementation")};b.onPrepareFleetBeaconSuccess=function(){var a;(a=this.$1)==null?void 0:a.onPrepareFleetBeaconSuccess()};b.onPrepareFleetBeaconFailed=function(){var a;(a=this.$1)==null?void 0:a.onPrepareFleetBeaconFailed()};b.subscribe=function(){throw new Error("Require implementation")};b.onSubscribe=function(){var a;(a=this.$1)==null?void 0:a.onSubscribe()};b.publish=function(){throw new Error("Require implementation")};b.cleanUpFleetBeacon=function(){throw new Error("Require implementation")};b.onCleanUpFinish=function(){var a;(a=this.$1)==null?void 0:a.onCleanUpFinish()};b.onPublishFailed=function(){var a;(a=this.$1)==null?void 0:a.onPublishFailed()};b.onPayloadReceived=function(){var a;(a=this.$1)==null?void 0:a.onPayloadReceived()};b.subscribeTimeoutIntervalMS=function(){return 1e4};b.payloadTimeoutIntervalMS=function(){return 2e4};b.publishWaitIntervalsMS=function(){return[1e4,5e3]};b.shouldStartTime=function(){return!0};b.onFleetBeaconStateTransition=function(a,b){var c=this,d=Date.now();this.$2.forEach(function(e){e.onFleetBeaconStateTransition(a,b,d,c)})};return a}();f["default"]=a}),66);
__d("FleetBeaconTestUIAnnouncer",["FleetBeaconStateTransitionListener"],(function(a,b,c,d,e,f,g){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b;b=a.call(this)||this;b.$FleetBeaconTestUIAnnouncer1=[];b.$FleetBeaconTestUIAnnouncer3=!1;b.$FleetBeaconTestUIAnnouncer4=!1;b.$FleetBeaconTestUIAnnouncer5=!1;b.$FleetBeaconTestUIAnnouncer6=!1;b.$FleetBeaconTestUIAnnouncer7=-1;b.$FleetBeaconTestUIAnnouncer8=-1;b.$FleetBeaconTestUIAnnouncer9=0;b.$FleetBeaconTestUIAnnouncer10=0;b.$FleetBeaconTestUIAnnouncer11=[];b.$FleetBeaconTestUIAnnouncer12=-1;b.$FleetBeaconTestUIAnnouncer13=-1;b.$FleetBeaconTestUIAnnouncer14=-1;return b}var c=b.prototype;c.cleanState=function(){this.$FleetBeaconTestUIAnnouncer3=!1,this.$FleetBeaconTestUIAnnouncer4=!1,this.$FleetBeaconTestUIAnnouncer5=!1,this.$FleetBeaconTestUIAnnouncer6=!1,this.$FleetBeaconTestUIAnnouncer7=-1,this.$FleetBeaconTestUIAnnouncer8=-1,this.$FleetBeaconTestUIAnnouncer9=0,this.$FleetBeaconTestUIAnnouncer10=0,this.$FleetBeaconTestUIAnnouncer11=[],this.$FleetBeaconTestUIAnnouncer12=-1,this.$FleetBeaconTestUIAnnouncer13=-1,this.$FleetBeaconTestUIAnnouncer14=-1};c.addSubscriber=function(a){this.$FleetBeaconTestUIAnnouncer1.push(a)};c.onFleetBeaconStateTransition=function(a,b,c,d){var e=d.getTestID(),f={oldState:a,newState:b,testID:e,timestamp:c,extra:{}};this.$FleetBeaconTestUIAnnouncer2==null&&(this.$FleetBeaconTestUIAnnouncer2=d);e="NONE";switch(b.getName()){case"initial":break;case"preparing":this.$FleetBeaconTestUIAnnouncer12=Date.now();this.$FleetBeaconTestUIAnnouncer3=!0;f.extra=babelHelpers["extends"]({},f.extra,{createIssued:!0});break;case"before_subscribe":this.$FleetBeaconTestUIAnnouncer13=Date.now();this.$FleetBeaconTestUIAnnouncer4=!0;f.extra=babelHelpers["extends"]({},f.extra,{createSuccess:!0});break;case"subscribe_issued":this.$FleetBeaconTestUIAnnouncer5=!0;f.extra=babelHelpers["extends"]({},f.extra,{subscribeIssued:!0,subscribeTimestamp:this.$FleetBeaconTestUIAnnouncer13,subscribeTimeoutIntervalMS:(d=(c=this.$FleetBeaconTestUIAnnouncer2)==null?void 0:c.subscribeTimeoutIntervalMS())!=null?d:-1});break;case"waiting_to_publish":a.getName()==="subscribe_issued"&&(this.$FleetBeaconTestUIAnnouncer6=!0,this.$FleetBeaconTestUIAnnouncer7=Date.now()-this.$FleetBeaconTestUIAnnouncer13,f.extra=babelHelpers["extends"]({},f.extra,{subscribeSuccess:!0,subscribeLatencyMS:this.$FleetBeaconTestUIAnnouncer7}));a.getName()==="publish_issued"&&this.$FleetBeaconTestUIAnnouncer15(f);break;case"publish_issued":this.$FleetBeaconTestUIAnnouncer9+=1;this.$FleetBeaconTestUIAnnouncer14=Date.now();f.extra=babelHelpers["extends"]({},f.extra,{publishIssued:!0,payloadTimeoutInterval:(c=(b=this.$FleetBeaconTestUIAnnouncer2)==null?void 0:b.payloadTimeoutIntervalMS())!=null?c:-1});break;case"failed":a.getName()==="subscribe_issued"&&(e="SUBSCRIBE_FAILED");a.getName()==="publish_issued"&&(e="RECEIVE_PUBLISH_FAILED");this.$FleetBeaconTestUIAnnouncer16(f,"FAILURE",e);break;case"succeed":a.getName()==="publish_issued"&&this.$FleetBeaconTestUIAnnouncer15(f);this.$FleetBeaconTestUIAnnouncer16(f,"SUCCESS","NONE");break;case"aborted":a.getName()==="preparing"&&(e="CREATE_TEST_FAILED");a.getName()==="publish_issued"&&(e="MUTATE_FIELD_FAILED");this.$FleetBeaconTestUIAnnouncer16(f,"ABORT",e);break;case"finish":f.extra=babelHelpers["extends"]({},f.extra,{cleanUpFinish:!0});break;default:}this.$FleetBeaconTestUIAnnouncer1.forEach(function(a){a(f)})};c.$FleetBeaconTestUIAnnouncer15=function(a){this.$FleetBeaconTestUIAnnouncer10+=1;var b=Date.now()-this.$FleetBeaconTestUIAnnouncer14;this.$FleetBeaconTestUIAnnouncer11.push(b);a.extra=babelHelpers["extends"]({},a.extra,{payloadSuccess:!0,payloadSuccessCnt:this.$FleetBeaconTestUIAnnouncer10,payloadLatency:b})};c.$FleetBeaconTestUIAnnouncer16=function(a,b,c){a.extra=babelHelpers["extends"]({},a.extra,{testResult:b,failureReason:c})};return b}(c("FleetBeaconStateTransitionListener"));g["default"]=a}),98);
__d("FleetBeaconSubscriptionNetwork",["CurrentUser","FleetBeaconSubscriptionNetwork_LogMutation.graphql","FleetBeaconSubscriptionNetwork_PublishMutation.graphql","FleetBeaconSubscriptionNetwork_Subscription.graphql","Promise","RelayModern","regeneratorRuntime","uuid"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;a=function(){function a(a){this.environment=a}var e=a.prototype;e.subscribe=function(a,c){return d("RelayModern").requestSubscription(this.environment,{subscription:h!==void 0?h:h=b("FleetBeaconSubscriptionNetwork_Subscription.graphql"),variables:{input:{test_id:a}},onError:c.onError,onNext:c.onNext})};e.publish=function(a){var e=this;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:return f.abrupt("return",new(b("Promise"))(function(f,g){d("RelayModern").commitMutation(e.environment,{mutation:i!==void 0?i:i=b("FleetBeaconSubscriptionNetwork_PublishMutation.graphql"),variables:{input:{client_mutation_id:c("uuid")(),actor_id:c("CurrentUser").getAccountID(),test_id:a}},onCompleted:function(a){return f()},onError:g})}));case 1:case"end":return f.stop()}},null,this)};e.log=function(a){var c=this;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new(b("Promise"))(function(e,f){d("RelayModern").commitMutation(c.environment,{mutation:j!==void 0?j:j=b("FleetBeaconSubscriptionNetwork_LogMutation.graphql"),variables:{input:a},onCompleted:function(a){return e()},onError:f})}));case 1:case"end":return e.stop()}},null,this)};return a}();g["default"]=a}),98);
__d("FleetBeaconTestSubscriptionLogger",["CurrentUser","FleetBeaconStateTransitionListener","RelayRTIUtils","uuid"],(function(a,b,c,d,e,f,g){a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){var e;e=a.call(this)||this;e.$FleetBeaconTestSubscriptionLogger1=null;e.$FleetBeaconTestSubscriptionLogger2=b;e.$FleetBeaconTestSubscriptionLogger3=!1;e.$FleetBeaconTestSubscriptionLogger4=!1;e.$FleetBeaconTestSubscriptionLogger5=!1;e.$FleetBeaconTestSubscriptionLogger6=!1;e.$FleetBeaconTestSubscriptionLogger7=-1;e.$FleetBeaconTestSubscriptionLogger8=-1;e.$FleetBeaconTestSubscriptionLogger9=0;e.$FleetBeaconTestSubscriptionLogger10=0;e.$FleetBeaconTestSubscriptionLogger11=[];e.$FleetBeaconTestSubscriptionLogger12=-1;e.$FleetBeaconTestSubscriptionLogger13=-1;e.$FleetBeaconTestSubscriptionLogger14=-1;e.$FleetBeaconTestSubscriptionLogger15=c;e.$FleetBeaconTestSubscriptionLogger16=d;return e}var e=b.prototype;e.cleanState=function(){this.$FleetBeaconTestSubscriptionLogger3=!1,this.$FleetBeaconTestSubscriptionLogger4=!1,this.$FleetBeaconTestSubscriptionLogger5=!1,this.$FleetBeaconTestSubscriptionLogger6=!1,this.$FleetBeaconTestSubscriptionLogger7=-1,this.$FleetBeaconTestSubscriptionLogger8=-1,this.$FleetBeaconTestSubscriptionLogger9=0,this.$FleetBeaconTestSubscriptionLogger10=0,this.$FleetBeaconTestSubscriptionLogger11=[],this.$FleetBeaconTestSubscriptionLogger12=-1,this.$FleetBeaconTestSubscriptionLogger13=-1,this.$FleetBeaconTestSubscriptionLogger14=-1};e.onFleetBeaconStateTransition=function(a,b,c,d){this.$FleetBeaconTestSubscriptionLogger1==null&&(this.$FleetBeaconTestSubscriptionLogger1=d);c="NONE";switch(b.getName()){case"initial":break;case"preparing":this.$FleetBeaconTestSubscriptionLogger12=Date.now();this.$FleetBeaconTestSubscriptionLogger3=!0;break;case"before_subscribe":this.$FleetBeaconTestSubscriptionLogger13=Date.now();this.$FleetBeaconTestSubscriptionLogger4=!0;break;case"subscribe_issued":this.$FleetBeaconTestSubscriptionLogger5=!0;break;case"waiting_to_publish":a.getName()==="subscribe_issued"&&(this.$FleetBeaconTestSubscriptionLogger6=!0,this.$FleetBeaconTestSubscriptionLogger7=Date.now()-this.$FleetBeaconTestSubscriptionLogger13);a.getName()==="publish_issued"&&this.$FleetBeaconTestSubscriptionLogger17();break;case"publish_issued":this.$FleetBeaconTestSubscriptionLogger9+=1;this.$FleetBeaconTestSubscriptionLogger14=Date.now();break;case"failed":a.getName()==="subscribe_issued"&&(c="SUBSCRIBE_FAILED");a.getName()==="publish_issued"&&(c="RECEIVE_PUBLISH_FAILED");this.$FleetBeaconTestSubscriptionLogger18("FAILURE",c);break;case"succeed":a.getName()==="publish_issued"&&this.$FleetBeaconTestSubscriptionLogger17();this.$FleetBeaconTestSubscriptionLogger18("SUCCESS","NONE");break;case"aborted":a.getName()==="preparing"&&(c="CREATE_TEST_FAILED");a.getName()==="publish_issued"&&(c="MUTATE_FIELD_FAILED");this.$FleetBeaconTestSubscriptionLogger18("ABORT",c);break;default:}};e.$FleetBeaconTestSubscriptionLogger17=function(){this.$FleetBeaconTestSubscriptionLogger10+=1;var a=Date.now()-this.$FleetBeaconTestSubscriptionLogger14;this.$FleetBeaconTestSubscriptionLogger11.push(a)};e.$FleetBeaconTestSubscriptionLogger18=function(a,b){var e,f=this,g=this.$FleetBeaconTestSubscriptionLogger12=Date.now()-this.$FleetBeaconTestSubscriptionLogger12,h=parseInt(this.$FleetBeaconTestSubscriptionLogger11.reduce(function(a,b){return a+b},0)/this.$FleetBeaconTestSubscriptionLogger10,10);e=(e=this.$FleetBeaconTestSubscriptionLogger1)==null?void 0:e.getTestID();if(e==null)return;this.$FleetBeaconTestSubscriptionLogger2.log({client_mutation_id:c("uuid")(),actor_id:c("CurrentUser").getAccountID(),test_id:e,test_name:"Web_Manual",test_result:a,failure_reason:b,subscribe_issued:this.$FleetBeaconTestSubscriptionLogger5,subscribe_success:this.$FleetBeaconTestSubscriptionLogger6,subscribe_latency_ms:this.$FleetBeaconTestSubscriptionLogger7,subscribe_timeout_interval_ms:(e=this.$FleetBeaconTestSubscriptionLogger1)==null?void 0:e.subscribeTimeoutIntervalMS(),publish_success:this.$FleetBeaconTestSubscriptionLogger10>0,publish_latency_ms:h,publish_timeout_interval_ms:(a=this.$FleetBeaconTestSubscriptionLogger1)==null?void 0:a.payloadTimeoutIntervalMS(),test_duration_ms:g,triggering_subscription:(b=this.$FleetBeaconTestSubscriptionLogger15)!=null?b:"manual",app_id:d("RelayRTIUtils").GRAPH_SERVICES_SDK_APP_ID}).then(function(a){f.$FleetBeaconTestSubscriptionLogger16(!0)})["catch"](function(a){f.$FleetBeaconTestSubscriptionLogger16(!1)})};return b}(c("FleetBeaconStateTransitionListener"));g["default"]=a}),98);
__d("FleetBeaconTestSubscription",["FleetBeaconTestBase","FleetBeaconTestSubscriptionLogger","FleetBeaconTestUIAnnouncer","uuid"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d,e){var f;f=a.call(this)||this;f.onCleanUpFleetBeaconFinish=function(a){f.onCleanUpFinish()};f.$FleetBeaconTestSubscription1=b;f.$FleetBeaconTestSubscription3=null;f.$FleetBeaconTestSubscription4=e;f.$FleetBeaconTestSubscription6=new(c("FleetBeaconTestSubscriptionLogger"))(b,d,f.onCleanUpFleetBeaconFinish);f.$FleetBeaconTestSubscription5=new(c("FleetBeaconTestUIAnnouncer"))();a.prototype.addStateTransitionListener.call(babelHelpers.assertThisInitialized(f),f.$FleetBeaconTestSubscription6);a.prototype.addStateTransitionListener.call(babelHelpers.assertThisInitialized(f),f.$FleetBeaconTestSubscription5);f.cleanPreviousFleetBeaconResult();return f}var d=b.prototype;d.cleanPreviousFleetBeaconResult=function(){a.prototype.cleanPreviousFleetBeaconResult.call(this),this.$FleetBeaconTestSubscription2=c("uuid")()};d.getTestID=function(){return this.$FleetBeaconTestSubscription2};d.getFleetBeaconUIAnnouncer=function(){return this.$FleetBeaconTestSubscription5};d.prepareFleetBeaconTest=function(){this.onPrepareFleetBeaconSuccess()};d.subscribe=function(){var a=this,b=this.$FleetBeaconTestSubscription2;if(b==null)return;this.$FleetBeaconTestSubscription3=this.$FleetBeaconTestSubscription1.subscribe(b,{onNext:function(){a.onPayloadReceived()},onError:function(){}});this.onSubscribe()};d.publish=function(){var b=this,c=this.$FleetBeaconTestSubscription2;if(c==null)return;this.$FleetBeaconTestSubscription1.publish(c)["catch"](function(c){a.prototype.onPublishFailed.call(b)})};d.cleanUpFleetBeacon=function(){};d.$FleetBeaconTestSubscription7=function(){var a;(a=this.$FleetBeaconTestSubscription3)==null?void 0:a.dispose()};d.onFleetBeaconStateTransition=function(b,c){a.prototype.onFleetBeaconStateTransition.call(this,b,c);b=c.getName();b==="finish"&&(this.$FleetBeaconTestSubscription4(),this.$FleetBeaconTestSubscription7())};return b}(c("FleetBeaconTestBase"));g["default"]=a}),98);
__d("FleetBeaconSubscriptionLauncher",["FleetBeaconRunner","FleetBeaconSubscriptionNetwork","FleetBeaconTestSubscription"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d){a=new(c("FleetBeaconTestSubscription"))(new(c("FleetBeaconSubscriptionNetwork"))(a),b,d);return a}function b(a){var b=new(c("FleetBeaconRunner"))(a);a.setFleetBeaconRunner(b);b.prepareFleetBeaconTest()}g.CreateFleetBeaconTestSubscription=a;g.LaunchFleetBeaconTestSubscription=b}),98);
__d("MqttLongPollingHookCollection",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Set()}var b=a.prototype;b.addHook=function(a){this.$1.add(a)};b.removeHook=function(a){this.$1["delete"](a)};b.onPollRequestSent=function(){this.$1.forEach(function(a){a.onPollRequestSent()})};b.onPollRequestSuccess=function(){this.$1.forEach(function(a){a.onPollRequestSuccess()})};b.onPollResponse=function(a){this.$1.forEach(function(b){b.onPollResponse(a)})};b.onPollFinish=function(){this.$1.forEach(function(a){a.onPollFinish()})};b.onPollRequestFailed=function(a){this.$1.forEach(function(b){b.onPollRequestFailed(a)})};return a}();f["default"]=a}),66);
__d("PromiseResult",["Promise"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){var a=this;this.promise=new(b("Promise"))(function(b,c){a.$1=b,a.$2=c})}var c=a.prototype;c.resolve=function(a){this.$1(a)};c.reject=function(a){this.$2(a)};return a}();f["default"]=a}),66);
__d("MqttFetchClient",["MqttEnv","MqttProtocolCodec","MqttUtils","Promise","PromiseResult"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttProtocolCodec").WireMessage,i=b("MqttProtocolCodec").decodeByteMessages,j=b("MqttProtocolCodec").MESSAGE_TYPE,k="fetch_pull",l="fetch_pull_finish",m="fetch_",n=6e4,o="action",p="chunked",q="send",r="true",s=5,t=20,u=10,v=5e3;a=function(){function a(){this.$1="",this.$2=g.getLoggerInstance(),this.$3=0,this.$4="",this.$6=function(){},this.$7=function(a){},this.$8=function(){},this.$9=function(a){},this.$10=0,this.$11=0,this.$12=0,this.$13=0,this.$14="Ready",this.$15=[],this.$16=[],this.$17=null,this.$18=!1,this.$19=0}a.isSupported=function(){return typeof fetch==="function"};var c=a.prototype;c.run=function(a,c,d,e,f,g,h,i){this.$1=b("MqttUtils").endpointWithSessionId(a,c),this.$3=c,this.$4=d,this.$5=e,this.$6=f,this.$7=g,this.$8=h,this.$9=i,this.$20()};c.isTopicSupported=function(a){return!0};c.publish=function(a,c){if(this.$14!=="ReceivingData"){this.$2.bumpCounter(m+"publish."+a+".invalidstate");return b("Promise").reject("not connected")}else{this.$2.bumpCounter(m+"publish."+a+".publish");var d=new(b("PromiseResult"))();a={topic:a,payload:c,promiseResult:d};this.$15.push(a);this.$21();return d.promise}};c.abort=function(){this.$6=function(){},this.$7=function(a){},this.$8=function(){},this.$9=function(a){}};c.$22=function(a){var b=this;a.forEach(function(a){b.$2.bumpCounter(m+"publish."+a.topic+".resolved"),a.promiseResult.resolve()});this.$12+=a.length};c.$23=function(a,b){var c=this;a.forEach(function(a){c.$2.bumpCounter(m+"publish."+a.topic+".rejected"),a.promiseResult.reject(b)})};c.$24=function(a,b,c,d){var e=a.map(function(a){return a.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request failed. Publishes:"+e+", retry:"+c);this.$2.bumpCounter(m+"publish_request_failed");this.$14!="ReceivingData"||c===s?(this.$23(a,d),this.$18=!1,this.$2.bumpCounter(m+"publish_request_failed_final"),this.$21()):this.$25(a,b,c+1)};c.$26=function(a,b,c,d){if(!d.ok){this.$2.bumpCounter(m+"publish_request_failed.http."+d.status);if(d.status===409){this.$19++;if(this.$19>=u){this.$2.bumpCounter(m+"409_reset");this.$27(new Error("Too many 409 errors"));return}}this.$24(a,b,c,this.$28(d));return}this.$2.bumpCounter(m+"publish_request_success");b=a.map(function(a){return a.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request success. Publishes:"+b+", retry:"+c);this.$22(a);this.$18=!1;this.$21()};c.$21=function(){if(this.$14!="ReceivingData")return;if(this.$18)return;if(this.$15.length==0&&this.$16.length==0)return;this.$18=!0;var a=this.$15.slice(0,t);this.$15=this.$15.slice(t,this.$15.length);clearTimeout(this.$17);this.$17=null;var b=this.$16.slice(0,t);this.$16=this.$16.slice(t,this.$16.length);this.$25(a,b,0)};c.$25=function(a,c,d){var e=this,f=a.map(function(a){return a.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request sent. Publishes:"+f+", retry:"+d);f=b("MqttUtils").endpointWithExtraParameter(this.$1,o,q);var h=a.map(function(a){return{topic:a.topic,payload:a.payload,qos:0,messageId:g.random()}});h=this.$5.gen(this.$3,[],h,c);this.$2.bumpCounter(m+"publish_request");b("MqttUtils").promiseDoneWithTimeout(fetch(f,{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",referrer:"no-referrer",body:h,keepalive:!1}),function(b){return e.$26(a,c,d,b)},function(b){return e.$24(a,c,d,b)},n)};c.$29=function(a){a=a.message;this.$2.debugTrace("FetchClient","Fetch request failed with error:"+a);this.$9(a);this.$30(!1,a);this.$2.bumpCounter(m+"error");this.$14="Error"};c.$31=function(a){var b=this;this.$2.debugTrace("FetchClient","Fetch response data received");a=i(new Uint8Array(a));a=a.messages;var c=a.filter(function(a){return a.messageType===j.PINGREQ});a=a.filter(function(a){return a.messageType===j.PUBLISH}).map(function(a){if(!(a instanceof h.Publish))return{};a=a;a.qos===1&&a.messageIdentifier!=null&&(b.$16.push(a.messageIdentifier),b.$17==null&&(b.$17=g.setTimeout(function(){b.$21()},v)));return{topic:a.topic,payload:a.payloadMessage.payloadString,qos:a.qos}});for(var d=a,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(e){if(f>=d.length)break;k=d[f++]}else{f=d.next();if(f.done)break;k=f.value}k=k;this.$2.bumpCounter(m+"response_"+k.topic)}a&&a.length>0&&(this.$13+=a.length,this.$7(a));c&&c.length>0&&this.$32()};c.$32=function(){this.$2.debugTrace("FetchClient","Got server ping request"),this.$2.bumpCounter(m+"ping")};c.$27=function(a){this.$2.debugTrace("FetchClient","Fetch request ended: "+a.toString()),this.$2.bumpCounter(m+"done"),this.$33(a.message),this.$8(),this.$14="Done"};c.$34=function(a,c,d){var e=this;if(d!==null&&d!==void 0)try{this.$31(d)}catch(a){this.$27(a);this.$2.bumpCounter(m+"dataDecodeException");return}if(c){this.$27(new Error("EOF"));return}b("MqttUtils").promiseDone(a.read(),function(c){var b=c.done;c=c.value;return e.$34(a,b,c)},function(a){return e.$27(a)})};c.$35=function(a){if(!a.ok){this.$2.bumpCounter(m+"error.http."+a.status);this.$29(this.$28(a));return}a=a.body;if(!a){this.$29(new Error("Empty body"));return}a=a.getReader();this.$6();this.$2.bumpCounter(m+"success");this.$30(!0,null);this.$11=Date.now();this.$14="ReceivingData";this.$2.debugTrace("FetchClient","Fetch request success");this.$34(a,!1,null)};c.$33=function(a){this.$2.eventLogPullFinish({pullEventName:l,sessionID:this.$3,duration:Date.now()-this.$11,errorMessage:a,publishReceived:this.$13,publishSent:this.$12})};c.$30=function(a,b){this.$2.eventLogPull({pullEventName:k,sessionID:this.$3,status:a,duration:Date.now()-this.$10,hostname:this.$1,errorMessage:b})};c.$20=function(){var a=this;if(this.$14!="Ready")return;this.$2.debugTrace("FetchClient","Sending fetch request");this.$2.bumpCounter(m+"request");this.$10=Date.now();var c=b("MqttUtils").endpointWithExtraParameter(this.$1,p,r);b("MqttUtils").promiseDoneWithTimeout(fetch(c,{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",referrer:"no-referrer",body:this.$4,keepalive:!1}),function(b){return a.$35(b)},function(b){return a.$29(b)},n)};c.$28=function(a){return new Error("Http error, status="+a.status)};return a}();e.exports=a}),null);
__d("MqttLongPollingClient",["MqttEnv","MqttProtocolCodec","Promise","XHRRequest","getCrossOriginTransport"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttProtocolCodec").WireMessage,i=b("MqttProtocolCodec").decodeByteMessages,j=120*1e3,k="simple_pull";a=function(){function a(){this.$3="",this.$4=0,this.$2=g.getLoggerInstance(),this.$1="Ready",this.$5="",this.$7=function(){},this.$8=function(a){},this.$9=function(){},this.$10=function(a){},this.$11=0,this.$12=null,this.$13=new Set(["/t_ms","/messenger_sync_get_diffs","/messenger_sync_create_queue","/webrtc","/rtc_multi"])}var c=a.prototype;c.run=function(a,b,c,d,e,f,g,h){this.$3=a,this.$4=b,this.$5=c,this.$6=d,this.$7=e,this.$8=f,this.$9=g,this.$10=h,this.$14(this.$5)};c.isTopicSupported=function(a){return this.$13.has(a)};c.publish=function(a,c){return b("Promise").reject("not supported")};c.abort=function(){this.$12!=null&&this.$12.abort("Disconnected")};c.$15=function(a,b){if(this.$1===a)return;this.$1=a;a=="Error"&&b!=null&&this.$10(b)};c.$16=function(a){if(this.$1!="RequestSend")return;if(!a){this.$17("EmptyResponse",null);return}this.$7();this.$18(!0,null);this.$15("ResponseReceived");a=i(new Uint8Array(a));a=a.messages.filter(function(a){return a instanceof h.Publish}).map(function(a){if(a instanceof h.Publish){a=a;return{topic:a.topic,payload:a.payloadMessage.payloadString,qos:a.qos}}else return{}});this.$8(a);this.$9()};c.$17=function(a,b){b=b!=null?b.message:"null";this.$2.debugTrace("LongPollingClient Error","Poll failed with error:"+a+", errorMsg:"+b);this.$18(!1,a+":"+b);this.$15("Error",a)};c.$18=function(a,b){this.$2.eventLogPull({pullEventName:k,sessionID:this.$4,status:a,duration:Date.now()-this.$11,hostname:this.$3,errorMessage:b})};c.$14=function(a){var c=this;if(this.$1!="Ready"||this.$12)return;try{this.$11=Date.now(),this.$12=new(b("XHRRequest"))(this.$3).setResponseType("arraybuffer").setRawData(a).setTransportBuilder(b("getCrossOriginTransport").withCredentials).setResponseHandler(function(a){return c.$16(a)}).setNetworkFailureHandler(function(a){c.$17("Network",a)}).setErrorHandler(function(a){c.$17("Error",a)}).setAbortHandler(function(a){c.$17("Abort",null)}).setTimeoutHandler(function(){c.$17("Timeout",null)}).setTimeout(j).send(),this.$15("RequestSend")}catch(a){this.$17("Error",a)}};return a}();e.exports=a}),null);
__d("MqttLongPollingRunner",["MqttEnv","MqttFetchClient","MqttLongPollingClient","MqttLongPollingHookCollection","MqttTypes","MqttUtils","Promise","exponentialBackoff"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttEnv").MqttGkNames,i=b("MqttTypes").MqttChannelError,j=4,k=1e3,l=3e3,m="mqtt_should_longpoll",n="last_lp",o="yes",p="no";a=function(){function a(a,c,d,e,f,j,k,l,m){var n=this;this.$23=function(){try{if(!n.$29())return;var a=n.$30();n.$14=a;var c=n.$9(),d=n.$10();c=c.filter(function(b){return a.isTopicSupported(b)});d=d.filter(function(b){return a.isTopicSupported(b.topic)});if(c.length==0&&d.length==0){n.$5.debugTrace("LongPollingRunner","Poll skipped, nothing to do");n.$14=null;g.setTimeout(function(){n.$23()},1e3);return}var e=b("MqttUtils").generateSessionId();a.run(n.$6,e,n.$7.gen(e,c,d),n.$7,function(){return n.$31()},function(a){return n.$32(a)},function(){return n.$33()},function(a){return n.$34(a)});n.$19.onPollRequestSent();e=c.join(",");c=d.map(function(a){return a.topic}).join(",");n.$5.debugTrace("LongPollingRunner","Making a poll request to "+n.$6+". SubscribedTopics:"+e+". Publishes:"+c)}catch(a){a&&n.$5.logErrorWarn(a,"lp_js_error"),n.$11(new i(!1,"js error lp",a)),n.$34("lp_js_error")}};this.$6=a;this.$7=c;this.$1=e;this.$2=0;this.$3=d;this.$4=b("MqttUtils").hasWSSupport();this.$5=g.getLoggerInstance();this.$8=f;this.$9=j;this.$10=k;this.$11=l;this.$12=m;this.$13=!1;this.$14=null;this.$15="LPInactive";this.$16="NotSent";this.$17=0;this.$19=new(b("MqttLongPollingHookCollection"))();this.$18=new(b("exponentialBackoff"))(this.$23,this);this.$20=0;this.$21=p;a=g.genGk(h.mqtt_lp_use_fetch);c=b("MqttFetchClient").isSupported();a?this.$5.bumpCounter("fetch_gk_pass"):this.$5.bumpCounter("fetch_gk_fail");c?this.$5.bumpCounter("fetch_api_supported"):this.$5.bumpCounter("fetch_api_not_supported");this.$22=a&&c}var c=a.prototype;c.addHook=function(a){this.$19.addHook(a)};c.start=function(){var a=this;this.$21=g.configRead(n,p);this.$5.debugTrace("LongPollingRunner","Runner loaded, last status "+this.$21);this.$20=Date.now();this.$23();g.setTimeout(function(){a.$23()},k+100);g.setTimeout(function(){a.$23()},l+100)};c.canPublish=function(){return this.$15==="LPActive"&&this.$16==="ReceivingData"};c.publish=function(a,c,d){return g.genGk(h.mqtt_enable_publish_over_polling)&&(this.$14&&this.$14.isTopicSupported(a))?this.$14.publish(a,c):b("Promise").reject()};c.onConnectAttempt=function(){};c.onConnectFailure=function(){this.$2++,this.$23()};c.onConnected=function(){};c.onConnectSuccess=function(){this.$1=!0,g.configWrite(n,null)};c.onConnectionLost=function(){};c.onSubscribe=function(a){};c.onUnsubscribe=function(a){};c.onPublish=function(a){};c.onMessage=function(a){};c.onWSFatal=function(){this.$3=!0,this.$23()};c.getStatus=function(){return this.$15};c.getRequestStatus=function(){return this.$16};c.$24=function(a){a!=this.$15&&(this.$5.debugTrace("LongPollingRunner","status changed to "+a+" from "+this.$15),this.$15=a,this.$12(this.$15,this.$16))};c.$25=function(a){if(!this.$22)return;a!==this.$16&&(this.$5.debugTrace("LongPollingRunner","request status changed to "+a+" from "+this.$16),this.$16=a,this.$12(this.$15,this.$16))};c.$26=function(){this.$17=0};c.$27=function(){this.$17++,this.$17>=j&&this.$24("LPError")};c.$28=function(){var a=g.genGk(h.mqtt_lp_no_delay),b=g.genGk(h.mqtt_ws_polling_enabled),c=g.genGk(h.mqtt_fast_lp);this.$5.debugTrace("LongPollingRunner","_shouldPoll? pollNow:"+String(a)+" enabled:"+String(b)+" fastPoll:"+String(c)+" hasWSSupport:"+String(this.$4)+" hasSuccess:"+String(this.$1)+" failureCount:"+this.$2+" wsFatal:"+String(this.$3));if(!b)return!1;if(a){this.$5.bumpCounter(m+".nd");return!0}if(!this.$4){this.$5.bumpCounter(m+".na");return!0}if(this.$3){this.$5.bumpCounter(m+".fatal");return!0}if(this.$1)return!1;if(c){b=Date.now()-this.$20;if(this.$21===o){if(this.$2>=1)return!0;if(b>k){this.$5.bumpCounter(m+".fastdelay");return!0}}else if(b>l){this.$5.bumpCounter(m+".regulardelay");return!0}}if(this.$2>=3){this.$5.bumpCounter(m+".failure");return!0}return!1};c.$29=function(){if(this.$14!=null)return!1;var a=this.$28();!this.$13&&a&&(this.$5.bumpCounter("polling_kickin"),this.$13=!0,this.$24("LPActive"),this.$26());this.$13&&!a&&(this.$5.bumpCounter("polling_stopped"),this.$13=!1,this.$24("LPInactive"),this.$26());return a};c.$30=function(){if(this.$22){this.$5.debugTrace("LongPollingRunner","Creating polling client using Fetch API");return new(b("MqttFetchClient"))()}else{this.$5.debugTrace("LongPollingRunner","Creating regular Polling client");return new(b("MqttLongPollingClient"))()}};c.$31=function(){this.$5.debugTrace("LongPollingRunner","Poll success"),this.$19.onPollRequestSuccess(),this.$18.reset(),this.$24("LPActive"),this.$26(),g.configWrite(n,o),this.$25("ReceivingData")};c.$32=function(a){var b=a.map(function(a){return a.topic}).join(",");this.$5.debugTrace("LongPollingRunner","Poll response received, message received:"+b);for(var b=0;b<a.length;b++){var c=a[b];this.$19.onPollResponse(c.topic);this.$8(c.topic,c.payload,c.qos)}};c.$33=function(){this.$5.debugTrace("LongPollingRunner","Poll finish"),this.$19.onPollFinish(),this.$14&&this.$14.abort(),this.$14=null,this.$23(),this.$25("NotSent")};c.$34=function(a){this.$19.onPollRequestFailed(a),this.$14&&this.$14.abort(),this.$14=null,this.$18(),this.$27(),this.$25("NotSent")};return a}();e.exports=a}),null);